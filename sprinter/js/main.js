/*
 Platform.js <https://mths.be/platform>
 Copyright 2014-2018 Benjamin Tan <https://bnjmnt4n.now.sh/>
 Copyright 2011-2013 John-David Dalton
 Available under MIT license <https://mths.be/mit>
*/
(function(){var b="undefined"!==typeof window&&"undefined"!==typeof window.document?window.document:{},a="undefined"!==typeof module&&module.exports,c="undefined"!==typeof Element&&"ALLOW_KEYBOARD_INPUT"in Element,d=function(){for(var a,c=["requestFullscreen exitFullscreen fullscreenElement fullscreenEnabled fullscreenchange fullscreenerror".split(" "),"webkitRequestFullscreen webkitExitFullscreen webkitFullscreenElement webkitFullscreenEnabled webkitfullscreenchange webkitfullscreenerror".split(" "),
"webkitRequestFullScreen webkitCancelFullScreen webkitCurrentFullScreenElement webkitCancelFullScreen webkitfullscreenchange webkitfullscreenerror".split(" "),"mozRequestFullScreen mozCancelFullScreen mozFullScreenElement mozFullScreenEnabled mozfullscreenchange mozfullscreenerror".split(" "),"msRequestFullscreen msExitFullscreen msFullscreenElement msFullscreenEnabled MSFullscreenChange MSFullscreenError".split(" ")],d=0,f=c.length,e={};d<f;d++)if((a=c[d])&&a[1]in b){for(d=0;d<a.length;d++)e[c[0][d]]=
a[d];return e}return!1}(),f={change:d.fullscreenchange,error:d.fullscreenerror},n={request:function(a){var f=d.requestFullscreen;a=a||b.documentElement;if(/5\.1[.\d]* Safari/.test(navigator.userAgent))a[f]();else a[f](c&&Element.ALLOW_KEYBOARD_INPUT)},exit:function(){b[d.exitFullscreen]()},toggle:function(a){this.isFullscreen?this.exit():this.request(a)},onchange:function(a){this.on("change",a)},onerror:function(a){this.on("error",a)},on:function(a,c){var d=f[a];d&&b.addEventListener(d,c,!1)},off:function(a,
c){var d=f[a];d&&b.removeEventListener(d,c,!1)},raw:d};d?(Object.defineProperties(n,{isFullscreen:{get:function(){return!!b[d.fullscreenElement]}},element:{enumerable:!0,get:function(){return b[d.fullscreenElement]}},enabled:{enumerable:!0,get:function(){return!!b[d.fullscreenEnabled]}}}),a?module.exports=n:window.screenfull=n):a?module.exports=!1:window.screenfull=!1})();
(function(){function b(a){a=String(a);return a.charAt(0).toUpperCase()+a.slice(1)}function a(a,b){var c=-1,f=a?a.length:0;if("number"==typeof f&&-1<f&&f<=v)for(;++c<f;)b(a[c],c,a);else d(a,b)}function c(a){a=String(a).replace(/^ +| +$/g,"");return/^(?:webOS|i(?:OS|P))/.test(a)?a:b(a)}function d(a,b){for(var c in a)r.call(a,c)&&b(a[c],c,a)}function f(a){return null==a?b(a):u.call(a).slice(8,-1)}function n(a,b){var c=null!=a?typeof a[b]:"number";return!/^(?:boolean|number|string|undefined)$/.test(c)&&
("object"==c?!!a[b]:!0)}function g(a){return String(a).replace(/([ -])(?!$)/g,"$1?")}function l(b,c){var d=null;a(b,function(a,f){d=c(d,a,f,b)});return d}function p(a){function b(b){return l(b,function(b,d){var f=d.pattern||g(d);!b&&(b=RegExp("\\b"+f+" *\\d+[.\\w_]*","i").exec(a)||RegExp("\\b"+f+" *\\w+-[\\w]*","i").exec(a)||RegExp("\\b"+f+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(a))&&((b=String(d.label&&!RegExp(f,"i").test(d.label)?d.label:b).split("/"))[1]&&!/[\d.]+/.test(b[0])&&(b[0]+=
" "+b[1]),d=d.label||d,b=c(b[0].replace(RegExp(f,"i"),d).replace(RegExp("; *(?:"+d+"[_-])?","i")," ").replace(RegExp("("+d+")[-_.]?(\\w)","i"),"$1 $2")));return b})}function v(b){return l(b,function(b,c){return b||(RegExp(c+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(a)||0)[1]||null})}var h=e,k=a&&"object"==typeof a&&"String"!=f(a);k&&(h=a,a=null);var w=h.navigator||{},r=w.userAgent||"";a||(a=r);var y=k?!!w.likeChrome:/\bChrome\b/.test(a)&&!/internal|\n/i.test(u.toString()),
x=k?"Object":"ScriptBridgingProxyObject",Q=k?"Object":"Environment",N=k&&h.java?"JavaPackage":f(h.java),U=k?"Object":"RuntimeObject";Q=(N=/\bJava/.test(N)&&h.java)&&f(h.environment)==Q;var T=N?"a":"\u03b1",V=N?"b":"\u03b2",S=h.document||{},J=h.operamini||h.opera,R=t.test(R=k&&J?J["[[Class]]"]:f(J))?R:J=null,m,M=a;k=[];var K=null,L=a==r;r=L&&J&&"function"==typeof J.version&&J.version();var z=function(b){return l(b,function(b,c){return b||RegExp("\\b"+(c.pattern||g(c))+"\\b","i").exec(a)&&(c.label||
c)})}([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),q=function(b){return l(b,function(b,c){return b||RegExp("\\b"+(c.pattern||g(c))+"\\b","i").exec(a)&&(c.label||c)})}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"Edge"},"Midori","Nook Browser",
"PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Waterfox","WebPositive","Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chrome",{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},
{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),C=b([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad",
"iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),H=function(b){return l(b,function(b,c,d){return b||(c[C]||c[/^[a-z]+(?: +[a-z]+\b)*/i.exec(C)]||RegExp("\\b"+g(d)+"(?:\\b|\\w*\\d)","i").exec(a))&&d})}({Apple:{iPad:1,iPhone:1,iPod:1},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},
"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1}}),A=function(b){return l(b,function(b,d){var f=d.pattern||g(d);if(!b&&(b=RegExp("\\b"+f+"(?:/[\\d.]+|[ \\w.]*)","i").exec(a))){var v=b,l=d.label||d,e={"10.0":"10","6.4":"10 Technical Preview",
"6.3":"8.1","6.2":"8","6.1":"Server 2008 R2 / 7","6.0":"Server 2008 / Vista","5.2":"Server 2003 / XP 64-bit","5.1":"XP","5.01":"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};f&&l&&/^Win/i.test(v)&&!/^Windows Phone /i.test(v)&&(e=e[/[\d.]+$/.exec(v)])&&(v="Windows "+e);v=String(v);f&&l&&(v=v.replace(RegExp(f,"i"),l));b=v=c(v.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/,
" $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}return b})}(["Windows Phone","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac",
"Windows 98;","Windows "]);z&&(z=[z]);H&&!C&&(C=b([H]));if(m=/\bGoogle TV\b/.exec(C))C=m[0];/\bSimulator\b/i.test(a)&&(C=(C?C+" ":"")+"Simulator");"Opera Mini"==q&&/\bOPiOS\b/.test(a)&&k.push("running in Turbo/Uncompressed mode");"IE"==q&&/\blike iPhone OS\b/.test(a)?(m=p(a.replace(/like iPhone OS/,"")),H=m.manufacturer,C=m.product):/^iP/.test(C)?(q||(q="Safari"),A="iOS"+((m=/ OS ([\d_]+)/i.exec(a))?" "+m[1].replace(/_/g,"."):"")):"Konqueror"!=q||/buntu/i.test(A)?H&&"Google"!=H&&(/Chrome/.test(q)&&
!/\bMobile Safari\b/i.test(a)||/\bVita\b/.test(C))||/\bAndroid\b/.test(A)&&/^Chrome/.test(q)&&/\bVersion\//i.test(a)?(q="Android Browser",A=/\bAndroid\b/.test(A)?A:"Android"):"Silk"==q?(/\bMobi/i.test(a)||(A="Android",k.unshift("desktop mode")),/Accelerated *= *true/i.test(a)&&k.unshift("accelerated")):"PaleMoon"==q&&(m=/\bFirefox\/([\d.]+)\b/.exec(a))?k.push("identifying as Firefox "+m[1]):"Firefox"==q&&(m=/\b(Mobile|Tablet|TV)\b/i.exec(a))?(A||(A="Firefox OS"),C||(C=m[1])):!q||(m=!/\bMinefield\b/i.test(a)&&
/\b(?:Firefox|Safari)\b/.exec(q))?(q&&!C&&/[\/,]|^[^(]+?\)/.test(a.slice(a.indexOf(m+"/")+8))&&(q=null),(m=C||H||A)&&(C||H||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(A))&&(q=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(A)?A:m)+" Browser")):"Electron"==q&&(m=(/\bChrome\/([\d.]+)\b/.exec(a)||0)[1])&&k.push("Chromium "+m):A="Kubuntu";r||(r=v(["(?:Cloud9|CriOS|CrMo|Edge|FxiOS|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$))","Version",g(q),"(?:Firefox|Minefield|NetFront)"]));
if(m="iCab"==z&&3<parseFloat(r)&&"WebKit"||/\bOpera\b/.test(q)&&(/\bOPR\b/.test(a)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(a)&&!/^(?:Trident|EdgeHTML)$/.test(z)&&"WebKit"||!z&&/\bMSIE\b/i.test(a)&&("Mac OS"==A?"Tasman":"Trident")||"WebKit"==z&&/\bPlayStation\b(?! Vita\b)/i.test(q)&&"NetFront")z=[m];"IE"==q&&(m=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(a)||0)[1])?(q+=" Mobile",A="Windows Phone "+(/\+$/.test(m)?m:m+".x"),k.unshift("desktop mode")):/\bWPDesktop\b/i.test(a)?(q="IE Mobile",A="Windows Phone 8.x",
k.unshift("desktop mode"),r||(r=(/\brv:([\d.]+)/.exec(a)||0)[1])):"IE"!=q&&"Trident"==z&&(m=/\brv:([\d.]+)/.exec(a))&&(q&&k.push("identifying as "+q+(r?" "+r:"")),q="IE",r=m[1]);if(L){if(n(h,"global"))if(N&&(m=N.lang.System,M=m.getProperty("os.arch"),A=A||m.getProperty("os.name")+" "+m.getProperty("os.version")),Q){try{r=h.require("ringo/engine").version.join("."),q="RingoJS"}catch(X){(m=h.system)&&m.global.system==h.system&&(q="Narwhal",A||(A=m[0].os||null))}q||(q="Rhino")}else"object"==typeof h.process&&
!h.process.browser&&(m=h.process)&&("object"==typeof m.versions&&("string"==typeof m.versions.electron?(k.push("Node "+m.versions.node),q="Electron",r=m.versions.electron):"string"==typeof m.versions.nw&&(k.push("Chromium "+r,"Node "+m.versions.node),q="NW.js",r=m.versions.nw)),q||(q="Node.js",M=m.arch,A=m.platform,r=(r=/[\d.]+/.exec(m.version))?r[0]:null));else f(m=h.runtime)==x?(q="Adobe AIR",A=m.flash.system.Capabilities.os):f(m=h.phantom)==U?(q="PhantomJS",r=(m=m.version||null)&&m.major+"."+m.minor+
"."+m.patch):"number"==typeof S.documentMode&&(m=/\bTrident\/(\d+)/i.exec(a))?(r=[r,S.documentMode],(m=+m[1]+4)!=r[1]&&(k.push("IE "+r[1]+" mode"),z&&(z[1]=""),r[1]=m),r="IE"==q?String(r[1].toFixed(1)):r[0]):"number"==typeof S.documentMode&&/^(?:Chrome|Firefox)\b/.test(q)&&(k.push("masking as "+q+" "+r),q="IE",r="11.0",z=["Trident"],A="Windows");A=A&&c(A)}r&&(m=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(r)||/(?:alpha|beta)(?: ?\d)?/i.exec(a+";"+(L&&w.appMinorVersion))||/\bMinefield\b/i.test(a)&&
"a")&&(K=/b/i.test(m)?"beta":"alpha",r=r.replace(RegExp(m+"\\+?$"),"")+("beta"==K?V:T)+(/\d+\+?/.exec(m)||""));if("Fennec"==q||"Firefox"==q&&/\b(?:Android|Firefox OS)\b/.test(A))q="Firefox Mobile";else if("Maxthon"==q&&r)r=r.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(C))"Xbox 360"==C&&(A=null),"Xbox 360"==C&&/\bIEMobile\b/.test(a)&&k.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(q)&&(!q||C||/Browser|Mobi/.test(q))||"Windows CE"!=A&&!/Mobi/i.test(a))if("IE"==q&&L)try{null===h.external&&
k.unshift("platform preview")}catch(X){k.unshift("embedded")}else(/\bBlackBerry\b/.test(C)||/\bBB10\b/.test(a))&&(m=(RegExp(C.replace(/ +/g," *")+"/([.\\d]+)","i").exec(a)||0)[1]||r)?(m=[m,/BB10/.test(a)],A=(m[1]?(C=null,H="BlackBerry"):"Device Software")+" "+m[0],r=null):this!=d&&"Wii"!=C&&(L&&J||/Opera/.test(q)&&/\b(?:MSIE|Firefox)\b/i.test(a)||"Firefox"==q&&/\bOS X (?:\d+\.){2,}/.test(A)||"IE"==q&&(A&&!/^Win/.test(A)&&5.5<r||/\bWindows XP\b/.test(A)&&8<r||8==r&&!/\bTrident\b/.test(a)))&&!t.test(m=
p.call(d,a.replace(t,"")+";"))&&m.name&&(m="ing as "+m.name+((m=m.version)?" "+m:""),t.test(q)?(/\bIE\b/.test(m)&&"Mac OS"==A&&(A=null),m="identify"+m):(m="mask"+m,q=R?c(R.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(m)&&(A=null),L||(r=null)),z=["Presto"],k.push(m));else q+=" Mobile";if(m=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(a)||0)[1]){m=[parseFloat(m.replace(/\.(\d)$/,".0$1")),m];if("Safari"==q&&"+"==m[1].slice(-1))q="WebKit Nightly",K="alpha",r=m[1].slice(0,-1);else if(r==m[1]||r==(m[2]=
(/\bSafari\/([\d.]+\+?)/i.exec(a)||0)[1]))r=null;m[1]=(/\bChrome\/([\d.]+)/i.exec(a)||0)[1];537.36==m[0]&&537.36==m[2]&&28<=parseFloat(m[1])&&"WebKit"==z&&(z=["Blink"]);L&&(y||m[1])?(z&&(z[1]="like Chrome"),m=m[1]||(m=m[0],530>m?1:532>m?2:532.05>m?3:533>m?4:534.03>m?5:534.07>m?6:534.1>m?7:534.13>m?8:534.16>m?9:534.24>m?10:534.3>m?11:535.01>m?12:535.02>m?"13+":535.07>m?15:535.11>m?16:535.19>m?17:536.05>m?18:536.1>m?19:537.01>m?20:537.11>m?"21+":537.13>m?23:537.18>m?24:537.24>m?25:537.36>m?26:"Blink"!=
z?"27":"28")):(z&&(z[1]="like Safari"),m=(m=m[0],400>m?1:500>m?2:526>m?3:533>m?4:534>m?"4+":535>m?5:537>m?6:538>m?7:601>m?8:"8"));z&&(z[1]+=" "+(m+="number"==typeof m?".x":/[.+]/.test(m)?"":"+"));"Safari"==q&&(!r||45<parseInt(r))&&(r=m)}"Opera"==q&&(m=/\bzbov|zvav$/.exec(A))?(q+=" ",k.unshift("desktop mode"),"zvav"==m?(q+="Mini",r=null):q+="Mobile",A=A.replace(RegExp(" *"+m+"$"),"")):"Safari"==q&&/\bChrome\b/.exec(z&&z[1])&&(k.unshift("desktop mode"),q="Chrome Mobile",r=null,/\bOS X\b/.test(A)?(H=
"Apple",A="iOS 4.3+"):A=null);r&&0==r.indexOf(m=/[\d.]+$/.exec(A))&&-1<a.indexOf("/"+m+"-")&&(A=String(A.replace(m,"")).replace(/^ +| +$/g,""));z&&!/\b(?:Avant|Nook)\b/.test(q)&&(/Browser|Lunascape|Maxthon/.test(q)||"Safari"!=q&&/^iOS/.test(A)&&/\bSafari\b/.test(z[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|Web)/.test(q)&&z[1])&&(m=z[z.length-1])&&k.push(m);k.length&&(k=["("+k.join("; ")+")"]);H&&C&&0>C.indexOf(H)&&k.push("on "+H);C&&k.push((/^on /.test(k[k.length-
1])?"":"on ")+C);if(A){var W=(m=/ ([\d.+]+)$/.exec(A))&&"/"==A.charAt(A.length-m[0].length-1);A={architecture:32,family:m&&!W?A.replace(m[0],""):A,version:m?m[1]:null,toString:function(){var a=this.version;return this.family+(a&&!W?" "+a:"")+(64==this.architecture?" 64-bit":"")}}}(m=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(M))&&!/\bi686\b/i.test(M)?(A&&(A.architecture=64,A.family=A.family.replace(RegExp(" *"+m),"")),q&&(/\bWOW64\b/i.test(a)||L&&/\w(?:86|32)$/.test(w.cpuClass||w.platform)&&!/\bWin64; x64\b/i.test(a))&&
k.unshift("32-bit")):A&&/^OS X/.test(A.family)&&"Chrome"==q&&39<=parseFloat(r)&&(A.architecture=64);a||(a=null);h={};h.description=a;h.layout=z&&z[0];h.manufacturer=H;h.name=q;h.prerelease=K;h.product=C;h.ua=a;h.version=q&&r;h.os=A||{architecture:null,family:null,version:null,toString:function(){return"null"}};h.parse=p;h.toString=function(){return this.description||""};h.version&&k.unshift(r);h.name&&k.unshift(q);A&&q&&(A!=String(A).split(" ")[0]||A!=q.split(" ")[0]&&!C)&&k.push(C?"("+A+")":"on "+
A);k.length&&(h.description=k.join(" "));return h}var h={"function":!0,object:!0},e=h[typeof window]&&window||this,k=h[typeof exports]&&exports;h=h[typeof module]&&module&&!module.nodeType&&module;var w=k&&h&&"object"==typeof global&&global;!w||w.global!==w&&w.window!==w&&w.self!==w||(e=w);var v=Math.pow(2,53)-1,t=/\bOpera/;w=Object.prototype;var r=w.hasOwnProperty,u=w.toString,x=p();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(e.platform=x,define(function(){return x})):k&&
h?d(x,function(a,b){k[b]=a}):e.platform=x}).call(this);
function buildIOSMeta(){for(var b=[{name:"viewport",content:"width=device-width, height=device-height, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no"},{name:"apple-mobile-web-app-capable",content:"yes"},{name:"apple-mobile-web-app-status-bar-style",content:"black"}],a=0;a<b.length;a++){var c=document.createElement("meta");c.name=b[a].name;c.content=b[a].content;var d=window.document.head.querySelector('meta[name="'+c.name+'"]');d&&d.parentNode.removeChild(d);window.document.head.appendChild(c)}}
function hideIOSFullscreenPanel(){jQuery(".xxx-ios-fullscreen-message").css("display","none");jQuery(".xxx-ios-fullscreen-scroll").css("display","none");jQuery(".xxx-game-iframe-full").removeClass("xxx-game-iframe-iphone-se")}function buildIOSFullscreenPanel(){jQuery("body").append('<div class="xxx-ios-fullscreen-message"><div class="xxx-ios-fullscreen-swipe"></div></div><div class="xxx-ios-fullscreen-scroll"></div>')}
function showIOSFullscreenPanel(){jQuery(".xxx-ios-fullscreen-message").css("display","block");jQuery(".xxx-ios-fullscreen-scroll").css("display","block")}
function __iosResize(){window.scrollTo(0,0);if("iPhone"===platform.product)switch(window.devicePixelRatio){case 2:switch(window.innerWidth){case 568:320!==window.innerHeight&&jQuery(".xxx-game-iframe-full").addClass("xxx-game-iframe-iphone-se");break;case 667:375===window.innerHeight?hideIOSFullscreenPanel():showIOSFullscreenPanel();break;default:hideIOSFullscreenPanel()}break;case 3:switch(window.innerWidth){case 736:414===window.innerHeight?hideIOSFullscreenPanel():showIOSFullscreenPanel();break;
case 724:375===window.innerHeight?hideIOSFullscreenPanel():showIOSFullscreenPanel();break;default:hideIOSFullscreenPanel()}break;default:hideIOSFullscreenPanel()}}function iosResize(){__iosResize();setTimeout(function(){__iosResize()},500)}function iosInIframe(){try{return window.self!==window.top}catch(b){return!0}}$(document).ready(function(){platform&&"iPhone"===platform.product&&!iosInIframe()&&(buildIOSFullscreenPanel(),buildIOSMeta())});
jQuery(window).resize(function(){platform&&"iPhone"===platform.product&&!iosInIframe()&&iosResize()});
(function(b){(jQuery.browser=jQuery.browser||{}).mobile=/android|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(ad|hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|tablet|treo|up\.(browser|link)|vodafone|wap|webos|windows (ce|phone)|xda|xiino/i.test(b)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|e\-|e\/|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(di|rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|xda(\-|2|g)|yas\-|your|zeto|zte\-/i.test(b.substr(0,4))})(navigator.userAgent||
navigator.vendor||window.opera);function trace(b){console.log(b)}$(window).resize(function(){sizeHandler()});function isChrome(){return/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}function isIOS(){var b="iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";");for(-1!==navigator.userAgent.toLowerCase().indexOf("iphone")&&(s_bIsIphone=!0);b.length;)if(navigator.platform===b.pop())return!0;return s_bIsIphone=!1}
function playSound(b,a,c){return!1===DISABLE_SOUND_MOBILE||!1===s_bMobile?(s_aSounds[b].play(),s_aSounds[b].volume(a),s_aSounds[b].loop(c),s_aSounds[b]):null}function stopSound(b){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aSounds[b].stop()}function setVolume(b,a){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aSounds[b].volume(a)}function setMute(b,a){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aSounds[b].mute(a)}
function getSize(b){var a=b.toLowerCase(),c=window.document,d=c.documentElement;if(void 0===window["inner"+b])b=d["client"+b];else if(window["inner"+b]!=d["client"+b]){var f=c.createElement("body");f.id="vpw-test-b";f.style.cssText="overflow:scroll";var n=c.createElement("div");n.id="vpw-test-d";n.style.cssText="position:absolute;top:-1000px";n.innerHTML="<style>@media("+a+":"+d["client"+b]+"px){body#vpw-test-b div#vpw-test-d{"+a+":7px!important}}</style>";f.appendChild(n);d.insertBefore(f,c.head);
b=7==n["offset"+b]?d["client"+b]:window["inner"+b];d.removeChild(f)}else b=window["inner"+b];return b}window.addEventListener("orientationchange",onOrientationChange);function onOrientationChange(){window.matchMedia("(orientation: portrait)").matches&&sizeHandler();window.matchMedia("(orientation: landscape)").matches&&sizeHandler()}function getIOSWindowHeight(){return document.documentElement.clientWidth/window.innerWidth*window.innerHeight}
function getHeightOfIOSToolbars(){var b=(0===window.orientation?screen.height:screen.width)-getIOSWindowHeight();return 1<b?b:0}
function sizeHandler(){window.scrollTo(0,1);if($("#canvas")){var b="safari"===platform.name.toLowerCase()?getIOSWindowHeight():getSize("Height");var a=getSize("Width");_checkOrientation(a,b);var c=Math.min(b/CANVAS_HEIGHT,a/CANVAS_WIDTH),d=CANVAS_WIDTH*c;c*=CANVAS_HEIGHT;if(c<b){var f=b-c;c+=f;d+=CANVAS_WIDTH/CANVAS_HEIGHT*f}else d<a&&(f=a-d,d+=f,c+=CANVAS_HEIGHT/CANVAS_WIDTH*f);f=b/2-c/2;var n=a/2-d/2,g=CANVAS_WIDTH/d;if(n*g<-EDGEBOARD_X||f*g<-EDGEBOARD_Y)c=Math.min(b/(CANVAS_HEIGHT-2*EDGEBOARD_Y),
a/(CANVAS_WIDTH-2*EDGEBOARD_X)),d=CANVAS_WIDTH*c,c*=CANVAS_HEIGHT,f=(b-c)/2,n=(a-d)/2,g=CANVAS_WIDTH/d;s_iOffsetX=-1*n*g;s_iOffsetY=-1*f*g;0<=f&&(s_iOffsetY=0);0<=n&&(s_iOffsetX=0);null!==s_oInterface&&s_oInterface.refreshButtonPos(s_iOffsetX,s_iOffsetY);null!==s_oMenu&&s_oMenu.refreshButtonPos(s_iOffsetX,s_iOffsetY);null!==s_oHealthBar&&s_oHealthBar.refreshButtonPos(s_iOffsetX,s_iOffsetY);null!==s_oMobileControls&&s_oMobileControls.refreshButtonPos(s_iOffsetX,s_iOffsetY);null!==s_oLevelMenu&&s_oLevelMenu.refreshButtonPos(s_iOffsetX,
s_iOffsetY);null!==s_oSelectTeam&&s_oSelectTeam.refreshButtonPos(s_iOffsetX,s_iOffsetY);null!==s_oPlayerProgress&&s_oPlayerProgress.refreshButtonPos(s_iOffsetX,s_iOffsetY);s_bIsIphone?(canvas=document.getElementById("canvas"),s_oStage.canvas.width=2*d,s_oStage.canvas.height=2*c,canvas.style.width=d+"px",canvas.style.height=c+"px",s_oStage.scaleX=s_oStage.scaleY=2*Math.min(d/CANVAS_WIDTH,c/CANVAS_HEIGHT)):s_bMobile||isChrome()?($("#canvas").css("width",d+"px"),$("#canvas").css("height",c+"px")):(s_oStage.canvas.width=
d,s_oStage.canvas.height=c,s_iScaleFactor=Math.min(d/CANVAS_WIDTH,c/CANVAS_HEIGHT),s_oStage.scaleX=s_oStage.scaleY=s_iScaleFactor);0>f||(f=(b-c)/2);$("#canvas").css("top",f+"px");$("#canvas").css("left",n+"px");fullscreenHandler()}}
function _checkOrientation(b,a){s_bMobile&&ENABLE_CHECK_ORIENTATION&&(b>a?"landscape"===$(".orientation-msg-container").attr("data-orientation")?($(".orientation-msg-container").css("display","none"),s_oMain.startUpdate()):($(".orientation-msg-container").css("display","block"),s_oMain.stopUpdate()):"portrait"===$(".orientation-msg-container").attr("data-orientation")?($(".orientation-msg-container").css("display","none"),s_oMain.startUpdate()):($(".orientation-msg-container").css("display","block"),
s_oMain.stopUpdate()))}function createBitmap(b,a,c){var d=new createjs.Bitmap(b),f=new createjs.Shape;a&&c?f.graphics.beginFill("#fff").drawRect(0,0,a,c):f.graphics.beginFill("#ff0").drawRect(0,0,b.width,b.height);d.hitArea=f;return d}function createSprite(b,a,c,d,f,n){b=null!==a?new createjs.Sprite(b,a):new createjs.Sprite(b);a=new createjs.Shape;a.graphics.beginFill("#000000").drawRect(-c,-d,f,n);b.hitArea=a;return b}
function randomFloatBetween(b,a,c){"undefined"===typeof c&&(c=2);return parseFloat(Math.min(b+Math.random()*(a-b),a).toFixed(c))}function rotateVector2D(b,a){var c=a.getX()*Math.cos(b)+a.getY()*Math.sin(b),d=a.getX()*-Math.sin(b)+a.getY()*Math.cos(b);a.set(c,d)}function tweenVectorsOnX(b,a,c){return b+c*(a-b)}function shuffle(b){for(var a=b.length,c,d;0!==a;)d=Math.floor(Math.random()*a),--a,c=b[a],b[a]=b[d],b[d]=c;return b}
function bubbleSort(b){do{var a=!1;for(var c=0;c<b.length-1;c++)b[c]>b[c+1]&&(a=b[c],b[c]=b[c+1],b[c+1]=a,a=!0)}while(a)}function compare(b,a){return b.index>a.index?-1:b.index<a.index?1:0}function easeLinear(b,a,c,d){return c*b/d+a}function easeInQuad(b,a,c,d){return c*(b/=d)*b+a}function easeInSine(b,a,c,d){return-c*Math.cos(b/d*(Math.PI/2))+c+a}function easeInCubic(b,a,c,d){return c*(b/=d)*b*b+a}function easeOutCubic(b,a,c,d,f){return c*((b=b/d-1)*b*b+1)+a}
function getTrajectoryPoint(b,a){var c=new createjs.Point,d=(1-b)*(1-b),f=b*b;c.x=d*a.start.x+2*(1-b)*b*a.traj.x+f*a.end.x;c.y=d*a.start.y+2*(1-b)*b*a.traj.y+f*a.end.y;return c}function formatTime(b){b/=1E3;var a=Math.floor(b/60),c=Math.floor(b-60*a),d=Math.floor(1E3*b%1E3);b=":"+d;10>d?b=":00"+d:100>d&&(b=":0"+d);d="";d=10>a?d+("0"+a+":"):d+(a+":");return(10>c?d+("0"+c):d+c)+b}function degreesToRadians(b){return b*Math.PI/180}
function checkRectCollision(b,a){var c=getBounds(b,.9);var d=getBounds(a,.98);return calculateIntersection(c,d)}function calculateIntersection(b,a){var c,d,f,n;var g=b.x+(c=b.width/2);var l=b.y+(d=b.height/2);var p=a.x+(f=a.width/2);var h=a.y+(n=a.height/2);g=Math.abs(g-p)-(c+f);l=Math.abs(l-h)-(d+n);return 0>g&&0>l?(g=Math.min(Math.min(b.width,a.width),-g),l=Math.min(Math.min(b.height,a.height),-l),{x:Math.max(b.x,a.x),y:Math.max(b.y,a.y),width:g,height:l,rect1:b,rect2:a}):null}
function getBounds(b,a){var c={x:Infinity,y:Infinity,width:0,height:0};if(b instanceof createjs.Container){c.x2=-Infinity;c.y2=-Infinity;var d=b.children,f=d.length,n;for(n=0;n<f;n++){var g=getBounds(d[n],1);g.x<c.x&&(c.x=g.x);g.y<c.y&&(c.y=g.y);g.x+g.width>c.x2&&(c.x2=g.x+g.width);g.y+g.height>c.y2&&(c.y2=g.y+g.height)}Infinity==c.x&&(c.x=0);Infinity==c.y&&(c.y=0);Infinity==c.x2&&(c.x2=0);Infinity==c.y2&&(c.y2=0);c.width=c.x2-c.x;c.height=c.y2-c.y;delete c.x2;delete c.y2}else{if(b instanceof createjs.Bitmap){f=
b.sourceRect||b.image;n=f.width*a;var l=f.height*a}else if(b instanceof createjs.Sprite)if(b.spriteSheet._frames&&b.spriteSheet._frames[b.currentFrame]&&b.spriteSheet._frames[b.currentFrame].image){f=b.spriteSheet.getFrame(b.currentFrame);n=f.rect.width;l=f.rect.height;d=f.regX;var p=f.regY}else c.x=b.x||0,c.y=b.y||0;else c.x=b.x||0,c.y=b.y||0;d=d||0;n=n||0;p=p||0;l=l||0;c.regX=d;c.regY=p;f=b.localToGlobal(0-d,0-p);g=b.localToGlobal(n-d,l-p);n=b.localToGlobal(n-d,0-p);d=b.localToGlobal(0-d,l-p);c.x=
Math.min(Math.min(Math.min(f.x,g.x),n.x),d.x);c.y=Math.min(Math.min(Math.min(f.y,g.y),n.y),d.y);c.width=Math.max(Math.max(Math.max(f.x,g.x),n.x),d.x)-c.x;c.height=Math.max(Math.max(Math.max(f.y,g.y),n.y),d.y)-c.y}return c}function NoClickDelay(b){this.element=b;window.Touch&&this.element.addEventListener("touchstart",this,!1)}function shuffle(b){for(var a=b.length,c,d;0<a;)d=Math.floor(Math.random()*a),a--,c=b[a],b[a]=b[d],b[d]=c;return b}
NoClickDelay.prototype={handleEvent:function(b){switch(b.type){case "touchstart":this.onTouchStart(b);break;case "touchmove":this.onTouchMove(b);break;case "touchend":this.onTouchEnd(b)}},onTouchStart:function(b){b.preventDefault();this.moved=!1;this.element.addEventListener("touchmove",this,!1);this.element.addEventListener("touchend",this,!1)},onTouchMove:function(b){this.moved=!0},onTouchEnd:function(b){this.element.removeEventListener("touchmove",this,!1);this.element.removeEventListener("touchend",
this,!1);if(!this.moved){b=document.elementFromPoint(b.changedTouches[0].clientX,b.changedTouches[0].clientY);3==b.nodeType&&(b=b.parentNode);var a=document.createEvent("MouseEvents");a.initEvent("click",!0,!0);b.dispatchEvent(a)}}};
(function(){function b(b){var c={focus:"visible",focusin:"visible",pageshow:"visible",blur:"hidden",focusout:"hidden",pagehide:"hidden"};b=b||window.event;b.type in c?document.body.className=c[b.type]:(document.body.className=this[a]?"hidden":"visible","hidden"===document.body.className?s_oMain.stopUpdate():s_oMain.startUpdate())}var a="hidden";a in document?document.addEventListener("visibilitychange",b):(a="mozHidden")in document?document.addEventListener("mozvisibilitychange",b):(a="webkitHidden")in
document?document.addEventListener("webkitvisibilitychange",b):(a="msHidden")in document?document.addEventListener("msvisibilitychange",b):"onfocusin"in document?document.onfocusin=document.onfocusout=b:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=b})();function ctlArcadeResume(){null!==s_oMain&&s_oMain.startUpdate()}function ctlArcadePause(){null!==s_oMain&&s_oMain.stopUpdate()}
function getParamValue(b){for(var a=window.location.search.substring(1).split("&"),c=0;c<a.length;c++){var d=a[c].split("=");if(d[0]==b)return d[1]}}function saveItem(b,a){s_bStorageAvailable&&localStorage.setItem(b,a)}function getItem(b){return s_bStorageAvailable?localStorage.getItem(b):null}function removeItem(b){s_bStorageAvailable&&localStorage.removeItem(b)}function clearAllItem(){s_bStorageAvailable&&localStorage.clear()}
function fullscreenHandler(){ENABLE_FULLSCREEN&&screenfull.enabled&&(s_bFullscreen=screenfull.isFullscreen,null!==s_oInterface&&s_oInterface.resetFullscreenBut(),null!==s_oMenu&&s_oMenu.resetFullscreenBut(),null!==s_oLevelMenu&&s_oLevelMenu.resetFullscreenBut(),null!==s_oSelectTeam&&s_oSelectTeam.resetFullscreenBut(),null!==s_oPlayerProgress&&s_oPlayerProgress.resetFullscreenBut())}
if(screenfull.enabled)screenfull.on("change",function(){s_bFullscreen=screenfull.isFullscreen;null!==s_oInterface&&s_oInterface.resetFullscreenBut();null!==s_oMenu&&s_oMenu.resetFullscreenBut();null!==s_oLevelMenu&&s_oLevelMenu.resetFullscreenBut();null!==s_oSelectTeam&&s_oSelectTeam.resetFullscreenBut();null!==s_oPlayerProgress&&s_oPlayerProgress.resetFullscreenBut()});
function CSpriteLibrary(){var b={},a,c,d,f,n,g;this.init=function(b,p,h){a={};d=c=0;f=b;n=p;g=h};this.addSprite=function(d,f){if(b.hasOwnProperty(d))return!1;var l=new Image;b[d]=a[d]={szPath:f,oSprite:l,bLoaded:!1};c++;return!0};this.getSprite=function(a){return b.hasOwnProperty(a)?b[a].oSprite:null};this._onSpritesLoaded=function(){c=0;n.call(g)};this._onSpriteLoaded=function(){f.call(g);++d===c&&this._onSpritesLoaded()};this.loadSprites=function(){for(var b in a)a[b].oSprite.oSpriteLibrary=this,
a[b].oSprite.szKey=b,a[b].oSprite.onload=function(){this.oSpriteLibrary.setLoaded(this.szKey);this.oSpriteLibrary._onSpriteLoaded(this.szKey)},a[b].oSprite.onerror=function(b){var c=b.currentTarget;setTimeout(function(){a[c.szKey].oSprite.src=a[c.szKey].szPath},500)},a[b].oSprite.src=a[b].szPath};this.setLoaded=function(a){b[a].bLoaded=!0};this.isLoaded=function(a){return b[a].bLoaded};this.getNumSprites=function(){return c}}
function CVector2(b,a){var c,d;this._init=function(a,b){c=a;d=b};this.add=function(a,b){c+=a;d+=b};this.addV=function(a){c+=a.getX();d+=a.getY()};this.scalarDivision=function(a){c/=a;d/=a};this.subV=function(a){c-=a.getX();d-=a.getY()};this.scalarProduct=function(a){c*=a;d*=a};this.invert=function(){c*=-1;d*=-1};this.dotProduct=function(a){return c*a.getX()+d*a.getY()};this.set=function(a,b){c=a;d=b};this.setV=function(a){c=a.getX();d=a.getY()};this.length=function(){return Math.sqrt(c*c+d*d)};this.length2=
function(){return c*c+d*d};this.normalize=function(){var a=this.length();0<a&&(c/=a,d/=a)};this.getNormalize=function(a){this.length();a.set(c,d);a.normalize()};this.rot90CCW=function(){var a=c;c=-d;d=a};this.rot90CW=function(){var a=c;c=d;d=-a};this.getRotCCW=function(a){a.set(c,d);a.rot90CCW()};this.getRotCW=function(a){a.set(c,d);a.rot90CW()};this.ceil=function(){c=Math.ceil(c);d=Math.ceil(d)};this.round=function(){c=Math.round(c);d=Math.round(d)};this.toString=function(){return"Vector2: "+c+", "+
d};this.print=function(){trace("Vector2: "+c+", "+d)};this.getX=function(){return c};this.getY=function(){return d};this._init(b,a)}
var CANVAS_WIDTH=1360,CANVAS_HEIGHT=640,EDGEBOARD_X=275,EDGEBOARD_Y=50,FONT="arialbold",FONT_2="pixel_lcd7regular",FPS=30,FPS_TIME=1E3/FPS,DISABLE_SOUND_MOBILE=!1,PLAYER_X_POSITION_IN_SELECTION=CANVAS_WIDTH/2,PLAYER_Y_POSITION_IN_SELECTION=CANVAS_HEIGHT/2+29,NUM_RUNNERS=8,PLAYER_WIDTH=165,PLAYER_HEIGHT=103,NUM_ROUNDS,NUM_POWER_UP_AVAILABLE=4,PLAYER_MAX_SPEED,PLAYER_MIN_SPEED,PLAYER_ENERGY,PLAYER_RESISTENCE_STEP,PLAYER_MAX_SPEED_ADDER,PLAYER_ENERGY_ADDER,ANIMATION_POSITION="position",ANIMATION_STARTING=
"starting",ANIMATION_RUNNING="run",ANIMATION_ENDING="ending",SPEED_DECELERATION=.3,MODIFIER_SPEED_ADDER=3,ENERGY_INCREASE=.15,ENEMY_MAX_SPEED=[19,20,20,,20,20,20,19],ENEMY_MIN_SPEED=[3,3,4,,4,4,3,3],ENEMY_ENERGY=[80,70,80,,100,90,80,80],ENEMY_RESISTENCE_STEP=[.5,.4,.4,,.3,.35,.4,.5],ENEMY_OCCURRENCE_RUN=[.7,.75,.75,,.75,.75,.75,.7],PLAYER_NAME_AND_SPRITE,WAIT_FOR_GAME_START=0,CONFIRMATION_ON_EXIT=1,CONFIRMATION_ON_CAREER_RESET=2,DIST_FROM_ARRIVAL,TEAM_0=0,TEAM_1=1,TEAM_2=2,TEAM_3=3,TEAM_4=4,TEAM_5=
5,TEAM_6=6,TEAM_7=7,LEFT_DIR=37,RIGHT_DIR=39,STATE_LOADING=0,STATE_MENU=1,STATE_HELP=1,STATE_GAME=3,ON_MOUSE_DOWN=0,ON_MOUSE_UP=1,ON_MOUSE_OVER=2,ON_MOUSE_OUT=3,ON_DRAG_START=4,ON_DRAG_END=5,ENABLE_FULLSCREEN,ENABLE_CHECK_ORIENTATION,SOUNDTRACK_VOLUME_IN_GAME=1,TEXT_POSITION="\u00b0 PLACE",TEXT_SCORE="SCORE: ",TEXT_CREDITS_DEVELOPED="DEVELOPED BY",TEXT_LINK1="WATCH DOCUMENTARIES",TEXT_START_MOVEMENT="MASH THE LEFT AND RIGHT KEYS TO BOOST YOUR POWER",TEXT_START_MOVEMENT_MOBILE="MASH THE LEFT AND RIGHT BUTTONS TO BOOST YOUR POWER",
HELP_ENERGY="KEEP YOUR ENERGY BAR FULL TO GO FASTER!",TEXT_ON_EXIT="DO YOU REALLY WANT TO QUIT THE GAME?",TEXT_ON_CAREER_RESET="ARE YOU SURE? ALL YOUR PREVIOUS SCORES WILL BE DELETED!",TEXT_HELP="HELP",TEXT_PRELOADER_CONTINUE="START",TEXT_CURRENCY="$",TEXT_LANE="LANE",TEXT_TIME="Time",TEXT_DISCIPLINE="MEN'S 100 METRES",TEXT_RESULT="RESULT",TEXT_UPGRADE="Upgrades - Medals",TEXT_BUY="BUY",TEXT_MONEY="MONEY",TEXT_ERR_LS="YOUR WEB BROWSER DOES NOT SUPPORT LOCAL STORAGE. IF YOU'RE USING SAFARI, IT MAY BE RELATED TO PRIVATE BROWSING. AS A RESULT, SOME INFO MAY NOT BE SAVED OR SOME FEATURES MAY NOT BE AVAILABLE.",
TEXT_TEAM_0="GERMANY",TEXT_TEAM_1="U.K.",TEXT_TEAM_2="TRINIDAD AND TOBAGO",TEXT_TEAM_3="RUSSIA",TEXT_TEAM_4="JAMAICA",TEXT_TEAM_5="U.S.A.",TEXT_TEAM_6="FRANCE",TEXT_TEAM_7="NETHERLANDS",CITY_NAME="SEATTLE;SAN FRANCISCO;MIAMI;NEW ORLEANS;CHICAGO;WASHINGTON;NEW YORK;LOS ANGELES;CLEVELAND;RIO".split(";"),TEXT_RUNNER="SELECT RUNNER",TEXT_MODE="SELECT MODE",TEXT_CHALLENGE="SELECT TRACK",TEXT_SHARE_IMAGE="200x200.jpg",TEXT_SHARE_TITLE="Congratulations!",TEXT_SHARE_MSG1="You collected <strong>",TEXT_SHARE_MSG2=
" points</strong>!<br><br>Share your score with your friends!",TEXT_SHARE_SHARE1="My score is ",TEXT_SHARE_SHARE2=" points! Can you do better";
function CPreloader(){var b,a,c,d,f,n,g,l,p,h;this._init=function(){s_oSpriteLibrary.init(this._onImagesLoaded,this._onAllImagesLoaded,this);s_oSpriteLibrary.addSprite("progress_bar","./sprites/progress_bar.png");s_oSpriteLibrary.addSprite("200x200","./sprites/200x200.jpg");s_oSpriteLibrary.addSprite("but_start","./sprites/but_start.png");s_oSpriteLibrary.loadSprites();h=new createjs.Container;s_oStage.addChild(h)};this.unload=function(){h.removeAllChildren();p.unload()};this._onImagesLoaded=function(){};
this._onAllImagesLoaded=function(){this.attachSprites();s_oMain.preloaderReady()};this.attachSprites=function(){var e=new createjs.Shape;e.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);h.addChild(e);e=s_oSpriteLibrary.getSprite("200x200");g=createBitmap(e);g.regX=.5*e.width;g.regY=.5*e.height;g.x=CANVAS_WIDTH/2;g.y=CANVAS_HEIGHT/2-180;h.addChild(g);l=new createjs.Shape;l.graphics.beginFill("rgba(0,0,0,0.01)").drawRoundRect(g.x-100,g.y-100,200,200,10);h.addChild(l);g.mask=l;
e=s_oSpriteLibrary.getSprite("progress_bar");d=createBitmap(e);d.x=CANVAS_WIDTH/2-e.width/2;d.y=CANVAS_HEIGHT/2+50;h.addChild(d);b=e.width;a=e.height;f=new createjs.Shape;f.graphics.beginFill("rgba(0,0,0,0.01)").drawRect(d.x,d.y,1,a);h.addChild(f);d.mask=f;c=new createjs.Text("","30px "+FONT,"#fff");c.x=CANVAS_WIDTH/2;c.y=CANVAS_HEIGHT/2+100;c.textBaseline="alphabetic";c.textAlign="center";h.addChild(c);e=s_oSpriteLibrary.getSprite("but_start");p=new CTextButton(CANVAS_WIDTH/2,CANVAS_HEIGHT/2,e,TEXT_PRELOADER_CONTINUE,
"Arial","#000","bold 50",h);p.addEventListener(ON_MOUSE_UP,this._onButStartRelease,this);p.setVisible(!1);n=new createjs.Shape;n.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);h.addChild(n);createjs.Tween.get(n).to({alpha:0},500).call(function(){createjs.Tween.removeTweens(n);h.removeChild(n)})};this._onButStartRelease=function(){s_oMain._onRemovePreloader()};this.refreshLoader=function(e){c.text=e+"%";100===e&&(s_oMain._onRemovePreloader(),c.visible=!1,d.visible=!1);f.graphics.clear();
e=Math.floor(e*b/100);f.graphics.beginFill("rgba(0,0,0,0.01)").drawRect(d.x,d.y,e,a)};this._init()}
function CMain(b){var a,c=0,d=0,f=STATE_LOADING,n,g;this.initContainer=function(){s_oCanvas=document.getElementById("canvas");s_oStage=new createjs.Stage(s_oCanvas);s_oStage.preventSelection=!1;createjs.Touch.enable(s_oStage);s_bMobile=jQuery.browser.mobile;!1===s_bMobile?(s_oStage.enableMouseOver(20),$("body").on("contextmenu","#canvas",function(a){return!1})):s_iScale=2;s_iPrevTime=(new Date).getTime();createjs.Ticker.addEventListener("tick",this._update);createjs.Ticker.framerate=FPS;navigator.userAgent.match(/Windows Phone/i)&&
(DISABLE_SOUND_MOBILE=!0);s_oSpriteLibrary=new CSpriteLibrary;n=new CPreloader};this.preloaderReady=function(){this._loadImages();!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||this._initSounds();a=!0};this.soundLoaded=function(){c++;n.refreshLoader(Math.floor(c/d*100))};this._initSounds=function(){Howler.mute(!s_bAudioActive);s_aSoundsInfo=[];s_aSoundsInfo.push({path:"./sounds/",filename:"crowd_cheers",loop:!1,volume:1,ingamename:"crowd_cheers"});s_aSoundsInfo.push({path:"./sounds/",filename:"click",
loop:!1,volume:1,ingamename:"click"});s_aSoundsInfo.push({path:"./sounds/",filename:"crowd",loop:!1,volume:1,ingamename:"crowd"});s_aSoundsInfo.push({path:"./sounds/",filename:"start_race",loop:!1,volume:1,ingamename:"start_race"});s_aSoundsInfo.push({path:"./sounds/",filename:"prepare_runner",loop:!1,volume:1,ingamename:"prepare_runner"});s_aSoundsInfo.push({path:"./sounds/",filename:"crowd_arrival",loop:!1,volume:1,ingamename:"crowd_arrival"});s_aSoundsInfo.push({path:"./sounds/",filename:"upgrade",
loop:!1,volume:1,ingamename:"upgrade"});s_aSoundsInfo.push({path:"./sounds/",filename:"soundtrack",loop:!0,volume:1,ingamename:"soundtrack"});d+=s_aSoundsInfo.length;s_aSounds=[];for(var a=0;a<s_aSoundsInfo.length;a++)this.tryToLoadSound(s_aSoundsInfo[a],!1)};this.tryToLoadSound=function(a,b){setTimeout(function(){s_aSounds[a.ingamename]=new Howl({src:[a.path+a.filename+".mp3"],autoplay:!1,preload:!0,loop:a.loop,volume:a.volume,onload:s_oMain.soundLoaded,onloaderror:function(a,b){for(var c=0;c<s_aSoundsInfo.length;c++)if(a===
s_aSounds[s_aSoundsInfo[c].ingamename]._sounds[0]._id){s_oMain.tryToLoadSound(s_aSoundsInfo[c],!0);break}},onplayerror:function(a){for(var b=0;b<s_aSoundsInfo.length;b++)if(a===s_aSounds[s_aSoundsInfo[b].ingamename]._sounds[0]._id){s_aSounds[s_aSoundsInfo[b].ingamename].once("unlock",function(){s_aSounds[s_aSoundsInfo[b].ingamename].play();"soundtrack"===s_aSoundsInfo[b].ingamename&&null!==s_oGame&&setVolume("soundtrack",SOUNDTRACK_VOLUME_IN_GAME)});break}}})},b?200:0)};this._loadImages=function(){s_oSpriteLibrary.init(this._onImagesLoaded,
this._onAllImagesLoaded,this);s_oSpriteLibrary.addSprite("but_play","./sprites/but_play.png");s_oSpriteLibrary.addSprite("but_restart","./sprites/but_restart.png");s_oSpriteLibrary.addSprite("but_continue","./sprites/but_continue.png");s_oSpriteLibrary.addSprite("but_continue_small","./sprites/but_continue_small.png");s_oSpriteLibrary.addSprite("but_exit","./sprites/but_exit.png");s_oSpriteLibrary.addSprite("but_info","./sprites/but_info.png");s_oSpriteLibrary.addSprite("audio_icon","./sprites/audio_icon.png");
s_oSpriteLibrary.addSprite("left_button","./sprites/left_button.png");s_oSpriteLibrary.addSprite("right_button","./sprites/right_button.png");s_oSpriteLibrary.addSprite("but_skip","./sprites/but_skip.png");s_oSpriteLibrary.addSprite("bg_menu","./sprites/bg_menu.jpg");s_oSpriteLibrary.addSprite("bg_select_team","./sprites/bg_select_team.jpg");s_oSpriteLibrary.addSprite("bg_podium","./sprites/bg_podium.jpg");s_oSpriteLibrary.addSprite("bg_select_challenge","./sprites/bg_select_challenge.jpg");s_oSpriteLibrary.addSprite("result_panel",
"./sprites/result_panel.png");s_oSpriteLibrary.addSprite("upgrade_panel","./sprites/upgrade_panel.png");s_oSpriteLibrary.addSprite("select_challenge","./sprites/select_challenge.png");s_oSpriteLibrary.addSprite("are_you_sure_panel","./sprites/are_you_sure_panel.png");s_oSpriteLibrary.addSprite("final_score","./sprites/final_score.png");s_oSpriteLibrary.addSprite("help_panel","./sprites/help_panel.png");s_oSpriteLibrary.addSprite("logo_credits","./sprites/logo_credits.png");s_oSpriteLibrary.addSprite("but_credits",
"./sprites/but_credits.png");s_oSpriteLibrary.addSprite("level_sprite","./sprites/level_sprite.png");s_oSpriteLibrary.addSprite("energy_bar","./sprites/energy_bar.png");s_oSpriteLibrary.addSprite("health","./sprites/health.png");s_oSpriteLibrary.addSprite("horizontal_bar","./sprites/horizontal_bar.png");s_oSpriteLibrary.addSprite("arrival_panel","./sprites/arrival_panel.png");s_oSpriteLibrary.addSprite("select_character","./sprites/select_character.png");s_oSpriteLibrary.addSprite("bar-1","./sprites/bar-1.png");
s_oSpriteLibrary.addSprite("bar-2","./sprites/bar-2.png");s_oSpriteLibrary.addSprite("gold_medal","./sprites/gold_medal.png");s_oSpriteLibrary.addSprite("silver_medal","./sprites/silver_medal.png");s_oSpriteLibrary.addSprite("bronze_medal","./sprites/bronze_medal.png");s_oSpriteLibrary.addSprite("arrow_bar","./sprites/arrow_bar.png");s_oSpriteLibrary.addSprite("but_yes","./sprites/but_yes.png");s_oSpriteLibrary.addSprite("bg_credits","./sprites/bg_credits.png");s_oSpriteLibrary.addSprite("left_directional_arrows",
"./sprites/left_directional_arrows.png");s_oSpriteLibrary.addSprite("right_directional_arrows","./sprites/right_directional_arrows.png");s_oSpriteLibrary.addSprite("time_panel","./sprites/time_panel.png");s_oSpriteLibrary.addSprite("podium","./sprites/podium.png");s_oSpriteLibrary.addSprite("but_fullscreen","./sprites/but_fullscreen.png");for(var a=0;a<NUM_RUNNERS;a++)s_oSpriteLibrary.addSprite("flag_runner_"+a,"./sprites/flag_runner_"+a+".png"),s_oSpriteLibrary.addSprite("flag_runner_"+a+"_game",
"./sprites/flag_runner_"+a+"_game.png"),s_oSpriteLibrary.addSprite("flag_"+a,"./sprites/flag_"+a+".jpg"),s_oSpriteLibrary.addSprite("runner_"+a,"./sprites/runners/runner_"+a+".png"),s_oSpriteLibrary.addSprite("runner_"+a+"_pose","./sprites/runners/poses/runner_"+a+"_pose.png");if(s_bMobile)for(a=0;18>a;a++)s_oSpriteLibrary.addSprite("track_"+a,"./sprites/track/redux/track_"+a+".jpg");else for(a=0;18>a;a++)s_oSpriteLibrary.addSprite("track_"+a,"./sprites/track/track_"+a+".jpg");d+=s_oSpriteLibrary.getNumSprites();
s_oSpriteLibrary.loadSprites()};this._onImagesLoaded=function(){c++;n.refreshLoader(Math.floor(c/d*100))};this._onAllImagesLoaded=function(){};this._onRemovePreloader=function(){try{saveItem("ls_available","ok")}catch(p){s_bStorageAvailable=!1}n.unload();s_oSoundtrack=playSound("soundtrack",1,!0);this.gotoMenu()};this.gotoMenu=function(){new CMenu;f=STATE_MENU};this.gotoTeamSelect=function(){new CSelectTeam;f=STATE_MENU};this.gotoSelectLevel=function(){new CLevelMenu;f=STATE_MENU};this.gotoGame=function(a){g=
new CGame(l,a);f=STATE_GAME};this.gotoPlayerProgress=function(){new CPlayerProgress;f=STATE_MENU};this.gotoHelp=function(){new CHelp;f=STATE_HELP};this.stopUpdate=function(){a=!1;createjs.Ticker.paused=!0;$("#block_game").css("display","block");!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||Howler.mute(!0)};this.startUpdate=function(){s_iPrevTime=(new Date).getTime();a=!0;createjs.Ticker.paused=!1;$("#block_game").css("display","none");(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)&&s_bAudioActive&&Howler.mute(!1)};
this._update=function(b){if(!1!==a){var c=(new Date).getTime();s_iTimeElaps=c-s_iPrevTime;s_iCntTime+=s_iTimeElaps;s_iCntFps++;s_iPrevTime=c;1E3<=s_iCntTime&&(s_iCurFps=s_iCntFps,s_iCntTime-=1E3,s_iCntFps=0);f===STATE_GAME&&g.update();s_oStage.update(b)}};s_oMain=this;var l=b;ENABLE_FULLSCREEN=b.fullscreen;ENABLE_CHECK_ORIENTATION=b.check_orientation;s_bAudioActive=b.audio_enable_on_startup;this.initContainer()}
var s_bMobile,s_bAudioActive=!0,s_bIsIphone=!0,s_iCntTime=0,s_iTimeElaps=0,s_iPrevTime=0,s_iCntFps=0,s_iCurFps=0,s_iLevelReached=1,s_iPlayerMoney=0,s_iSpeedBought=0,s_iEnergyBought=0,s_iSpeedAdder=0,s_iEnergyAdder=0,s_iTeamSelected=0,s_szTeamSelectedSprite="runner_0",s_aRunnersScore=[0,0,0,0,0,0,0,0],s_iScale=1,s_oCityInfos=null,s_oStage,s_oMain,s_oSpriteLibrary,s_oSoundtrack=null,s_oCanvas,s_bFullscreen=!1,s_bStorageAvailable=!0,s_aSounds;
function CTextButton(b,a,c,d,f,n,g,l){var p,h,e,k,w,v,t,r,u,x;this._init=function(a,b,c,d,f,v,l,g){p=!1;k=[];w=[];x=createBitmap(c);h=c.width;e=c.height;var n=Math.ceil(l/20);r=new createjs.Text(d,l+"px "+f,"#000000");var Q=r.getBounds();r.textAlign="center";r.lineWidth=.9*h;r.textBaseline="alphabetic";r.x=c.width/2+n;r.y=Math.floor(c.height/2)+Q.height/3+n;u=new createjs.Text(d,l+"px "+f,v);u.textAlign="center";u.textBaseline="alphabetic";u.lineWidth=.9*h;u.x=c.width/2;u.y=Math.floor(c.height/2)+
Q.height/3;t=new createjs.Container;t.x=a;t.y=b;t.regX=c.width/2;t.regY=c.height/2;s_bMobile||(t.cursor="pointer");t.addChild(x,r,u);!1!==g&&s_oStage.addChild(t);this._initListener()};this.unload=function(){t.off("mousedown");t.off("pressup");s_oStage.removeChild(t)};this.setVisible=function(a){t.visible=a};this.setAlign=function(a){u.textAlign=a;r.textAlign=a};this.enable=function(){p=!1;x.filters=[];x.cache(0,0,h,e)};this.disable=function(){p=!0;var a=(new createjs.ColorMatrix).adjustSaturation(-100).adjustBrightness(40);
x.filters=[new createjs.ColorMatrixFilter(a)];x.cache(0,0,h,e)};this._initListener=function(){t.on("mousedown",this.buttonDown);t.on("pressup",this.buttonRelease)};this.addEventListener=function(a,b,c){k[a]=b;w[a]=c};this.addEventListenerWithParams=function(a,b,c,d){k[a]=b;w[a]=c;v=d};this.buttonRelease=function(){p||(playSound("click",1,!1),t.scaleX=1,t.scaleY=1,k[ON_MOUSE_UP]&&k[ON_MOUSE_UP].call(w[ON_MOUSE_UP],v))};this.buttonDown=function(){p||(t.scaleX=.9,t.scaleY=.9,k[ON_MOUSE_DOWN]&&k[ON_MOUSE_DOWN].call(w[ON_MOUSE_DOWN]))};
this.setPosition=function(a,b){t.x=a;t.y=b};this.changeText=function(a){u.text=a;r.text=a};this.setX=function(a){t.x=a};this.setY=function(a){t.y=a};this.getButtonImage=function(){return t};this.getX=function(){return t.x};this.getY=function(){return t.y};this.getSprite=function(){return t};this._init(b,a,c,d,f,n,g,l);return this}
function CToggle(b,a,c,d,f){var n,g,l,p=[],h,e,k;this._init=function(a,b,c,d){g=[];l=[];var f=new createjs.SpriteSheet({images:[c],frames:{width:c.width/2,height:c.height,regX:c.width/2/2,regY:c.height/2},animations:{state_true:[0],state_false:[1]}});n=d;k=createSprite(f,"state_"+n,c.width/2/2,c.height/2,c.width/2,c.height);k.x=a;k.y=b;k.cursor="pointer";k.stop();w.addChild(k);this._initListener()};this.unload=function(){k.off("mousedown",h);k.off("pressup",e);w.removeChild(k)};this._initListener=
function(){h=k.on("mousedown",this.buttonDown);e=k.on("pressup",this.buttonRelease)};this.addEventListener=function(a,b,c){g[a]=b;l[a]=c};this.addEventListenerWithParams=function(a,b,c,d){g[a]=b;l[a]=c;p=d};this.setActive=function(a){n=a;k.gotoAndStop("state_"+n)};this.buttonRelease=function(){k.scaleX=1;k.scaleY=1;playSound("click",1,!1);n=!n;k.gotoAndStop("state_"+n);g[ON_MOUSE_UP]&&g[ON_MOUSE_UP].call(l[ON_MOUSE_UP],p)};this.buttonDown=function(){k.scaleX=.9;k.scaleY=.9;g[ON_MOUSE_DOWN]&&g[ON_MOUSE_DOWN].call(l[ON_MOUSE_DOWN],
p)};this.setPosition=function(a,b){k.x=a;k.y=b};this.setVisible=function(a){k.visible=a};this.getY=function(){return k.y};var w=f;this._init(b,a,c,d)}
function CGfxButton(b,a,c,d){var f,n,g,l,p,h=[],e;this._init=function(a,b,c){f=1;l=[];p=[];e=createBitmap(c);e.x=a;e.y=b;e.regX=c.width/2;e.regY=c.height/2;e.cursor="pointer";k.addChild(e);this._initListener()};this.unload=function(){e.off("mousedown",n);e.off("pressup",g);k.removeChild(e)};this.setVisible=function(a){e.visible=a};this._initListener=function(){n=e.on("mousedown",this.buttonDown);g=e.on("pressup",this.buttonRelease)};this.addEventListener=function(a,b,c){l[a]=b;p[a]=c};this.addEventListenerWithParams=
function(a,b,c,d){l[a]=b;p[a]=c;h=d};this.buttonRelease=function(){e.scaleX=f;e.scaleY=f;playSound("click",1,!1);l[ON_MOUSE_UP]&&l[ON_MOUSE_UP].call(p[ON_MOUSE_UP],h)};this.buttonDown=function(){e.scaleX=.9*f;e.scaleY=.9*f;l[ON_MOUSE_DOWN]&&l[ON_MOUSE_DOWN].call(p[ON_MOUSE_DOWN],h)};this.setScale=function(a){f=a;e.scaleX=a;e.scaleY=a};this.setPosition=function(a,b){e.x=a;e.y=b};this.setX=function(a){e.x=a};this.setY=function(a){e.y=a};this.getButtonImage=function(){return e};this.getX=function(){return e.x};
this.getY=function(){return e.y};var k=d;this._init(b,a,c);return this}
function CMenu(){var b,a,c,d,f,n,g,l,p,h,e,k,w=null,v,t,r,u=null,x,y=null,B=null;this._init=function(){!s_bStorageAvailable||null===getItem("100metres_LevelReached")||s_iLevelReached>=s_oCityInfos.getNumLevels()?this.removeLocalStorage():(s_iLevelReached=parseInt(getItem("100metres_LevelReached")),s_iPlayerMoney=parseInt(getItem("100metres_Money")),s_iSpeedBought=parseInt(getItem("100metres_SpeedBought")),s_iEnergyBought=parseInt(getItem("100metres_EnergyBought")),s_iSpeedAdder=parseInt(parseInt(getItem("100metres_SpeedAdder"))),
s_iEnergyAdder=parseInt(getItem("100metres_EnergyAdder")),s_iTeamSelected=parseInt(getItem("100metres_TeamSelected")),s_szTeamSelectedSprite=getItem("100metres_TeamSelectedSprite"),s_aRunnersScore=JSON.parse(getItem("100metres_Scores")),s_oCityInfos.getCitiesStorage());e=createBitmap(s_oSpriteLibrary.getSprite("bg_menu"));s_oStage.addChild(e);if(2>s_iLevelReached){var u=s_oSpriteLibrary.getSprite("but_play");g=CANVAS_WIDTH/2;l=CANVAS_HEIGHT-110;k=new CGfxButton(g,l,u,s_oStage);k.addEventListener(ON_MOUSE_UP,
this._onButPlayRelease,this)}else u=s_oSpriteLibrary.getSprite("but_play"),g=CANVAS_WIDTH/2-200,l=CANVAS_HEIGHT-110,k=new CGfxButton(g,l,u,s_oStage),k.addEventListener(ON_MOUSE_UP,this._onButPlayRelease,this),u=s_oSpriteLibrary.getSprite("but_continue"),f=CANVAS_WIDTH/2+200,n=CANVAS_HEIGHT-110,w=new CGfxButton(f,n,u,s_oStage),w.addEventListener(ON_MOUSE_UP,this._onButContinueRelease,this);u=s_oSpriteLibrary.getSprite("but_credits");c=CANVAS_WIDTH-u.height/2-10;d=u.height/2+10;v=new CGfxButton(c,d,
u,s_oStage);v.addEventListener(ON_MOUSE_UP,this._onCredits,this);if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)u=s_oSpriteLibrary.getSprite("audio_icon"),p=CANVAS_WIDTH-u.height/2-90,h=u.height/2+10,r=new CToggle(p,h,u,s_bAudioActive,s_oStage),r.addEventListener(ON_MOUSE_UP,this._onAudioToggle,this);u=window.document;var E=u.documentElement;y=E.requestFullscreen||E.mozRequestFullScreen||E.webkitRequestFullScreen||E.msRequestFullscreen;B=u.exitFullscreen||u.mozCancelFullScreen||u.webkitExitFullscreen||
u.msExitFullscreen;!1===ENABLE_FULLSCREEN&&(y=!1);y&&screenfull.enabled&&(u=s_oSpriteLibrary.getSprite("but_fullscreen"),b=u.width/4+10,a=u.height/2+10,x=new CToggle(b,a,u,s_bFullscreen,s_oStage),x.addEventListener(ON_MOUSE_UP,this._onFullscreen,this));t=new createjs.Shape;t.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);s_oStage.addChild(t);createjs.Tween.get(t).to({alpha:0},1E3).call(function(){t.visible=!1});this.refreshButtonPos(s_iOffsetX,s_iOffsetY);s_bStorageAvailable||
new CMsgBox(TEXT_ERR_LS,s_oStage);setVolume("soundtrack",1)};this.unload=function(){k.unload();k=null;t.visible=!1;v.unload();if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)r.unload(),r=null;y&&screenfull.enabled&&x.unload();null!==u&&(u.unload(),u=null);s_oStage.removeChild(e);s_oMenu=e=null};this.removeLocalStorage=function(){s_iLevelReached=1;s_iTeamSelected=s_iEnergyAdder=s_iSpeedAdder=s_iEnergyBought=s_iSpeedBought=s_iPlayerMoney=0;s_szTeamSelectedSprite="runner_0";s_aRunnersScore=[0,0,0,0,0,0,
0,0];s_oCityInfos.removeCitiesStorage();removeItem("100metres_LevelReached");removeItem("100metres_Money");removeItem("100metres_SpeedBought");removeItem("100metres_EnergyBought");removeItem("100metres_SpeedAdder");removeItem("100metres_EnergyAdder");removeItem("100metres_TeamSelected");removeItem("100metres_TeamSelectedSprite");removeItem("100metres_Scores")};this.refreshButtonPos=function(e,t){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||r.setPosition(p-e,t+h);k.setPosition(g,l-t);w&&w.setPosition(f,
n-t);y&&screenfull.enabled&&x.setPosition(b+e,a+t);v.setPosition(c-e,t+d)};this._onAudioToggle=function(){Howler.mute(s_bAudioActive);s_bAudioActive=!s_bAudioActive};this._onCredits=function(){new CCreditsPanel};this._onButPlayRelease=function(){$(s_oMain).trigger("start_session");2>s_iLevelReached?(this.unload(),s_oMain.gotoTeamSelect()):null===u&&(u=new CVariousHelp(TEXT_ON_CAREER_RESET,CONFIRMATION_ON_CAREER_RESET))};this._onButContinueRelease=function(){$(s_oMain).trigger("start_session");this.unload();
s_oMain.gotoSelectLevel()};this.unloadVariousHelp=function(){u.unload();u=null};this.onContinue=function(){this.removeLocalStorage();this.unload();s_oMain.gotoTeamSelect()};this.resetFullscreenBut=function(){y&&screenfull.enabled&&x.setActive(s_bFullscreen)};this._onFullscreen=function(){s_bFullscreen?B.call(window.document):y.call(window.document.documentElement);sizeHandler()};s_oMenu=this;null!==s_oCityInfos&&(s_oCityInfos.unload(),s_oCityInfos=null);s_oCityInfos=new CCitySettings;this._init()}
var s_oMenu=null;
function CSelectTeam(){var b,a,c,d,f,n,g,l,p=0,h,e,k,w,v,t,r,u,x,y,B,D,E,F=null,I=null,O,G,P;this._init=function(){s_iTeamSelected=0;s_szTeamSelectedSprite="runner_0";O=createBitmap(s_oSpriteLibrary.getSprite("bg_select_team"));s_oStage.addChild(O);var e=new createjs.Shape;e.graphics.beginFill("rgba(0,0,0,0.6)").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);s_oStage.addChild(e);e=s_oSpriteLibrary.getSprite("select_character");var p=createBitmap(e);p.x=CANVAS_WIDTH/2;p.y=CANVAS_HEIGHT/2;p.regX=e.width/
2;p.regY=e.height/2;s_oStage.addChild(p);new CTLText(s_oStage,CANVAS_WIDTH/2-190,108,400,24,24,"left","#fff",FONT,1,0,0,TEXT_RUNNER,!0,!0,!1,!1);k=new CTLText(s_oStage,CANVAS_WIDTH/2-190,138,400,22,22,"left","#fff",FONT,1,0,0,TEXT_TEAM_0,!0,!0,!1,!1);e=s_oSpriteLibrary.getSprite("but_continue_small");c=CANVAS_WIDTH/2+340;d=CANVAS_HEIGHT-140;w=new CGfxButton(c,d,e,s_oStage);w.addEventListener(ON_MOUSE_UP,this._onButNextRelease,this);e=s_oSpriteLibrary.getSprite("but_exit");g=CANVAS_WIDTH-e.height/
2-10;l=e.height/2+10;G=new CGfxButton(g,l,e,s_oStage);G.addEventListener(ON_MOUSE_UP,this._onExit,this);f=CANVAS_WIDTH-e.width/2-90;n=e.height/2+10;if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)e=s_oSpriteLibrary.getSprite("audio_icon"),P=new CToggle(f,n,e,s_bAudioActive,s_oStage),P.addEventListener(ON_MOUSE_UP,this._onAudioToggle,this);e=window.document;p=e.documentElement;F=p.requestFullscreen||p.mozRequestFullScreen||p.webkitRequestFullScreen||p.msRequestFullscreen;I=e.exitFullscreen||e.mozCancelFullScreen||
e.webkitExitFullscreen||e.msExitFullscreen;!1===ENABLE_FULLSCREEN&&(F=!1);F&&screenfull.enabled&&(e=s_oSpriteLibrary.getSprite("but_fullscreen"),b=e.width/4+10,a=e.height/2+10,E=new CToggle(b,a,e,s_bFullscreen,s_oStage),E.addEventListener(ON_MOUSE_UP,this._onFullscreen,this));h=new createjs.Container;s_oStage.addChild(h);this.showPlayerPose(PLAYER_X_POSITION_IN_SELECTION,PLAYER_Y_POSITION_IN_SELECTION,s_szTeamSelectedSprite);e=s_oSpriteLibrary.getSprite("flag_runner_0");D=new CToggle(CANVAS_WIDTH/
2-180,CANVAS_HEIGHT/2-100,e,!1,s_oStage);D.addEventListenerWithParams(ON_MOUSE_UP,this._onModeToggle,this,TEAM_0);e=s_oSpriteLibrary.getSprite("flag_runner_1");B=new CToggle(CANVAS_WIDTH/2-180,CANVAS_HEIGHT/2-20,e,!0,s_oStage);B.addEventListenerWithParams(ON_MOUSE_UP,this._onModeToggle,this,TEAM_1);e=s_oSpriteLibrary.getSprite("flag_runner_2");r=new CToggle(CANVAS_WIDTH/2-180,CANVAS_HEIGHT/2+60,e,!0,s_oStage);r.addEventListenerWithParams(ON_MOUSE_UP,this._onModeToggle,this,TEAM_2);e=s_oSpriteLibrary.getSprite("flag_runner_3");
u=new CToggle(CANVAS_WIDTH/2-180,CANVAS_HEIGHT/2+145,e,!0,s_oStage);u.addEventListenerWithParams(ON_MOUSE_UP,this._onModeToggle,this,TEAM_3);e=s_oSpriteLibrary.getSprite("flag_runner_4");v=new CToggle(CANVAS_WIDTH/2+180,CANVAS_HEIGHT/2-100,e,!0,s_oStage);v.addEventListenerWithParams(ON_MOUSE_UP,this._onModeToggle,this,TEAM_4);e=s_oSpriteLibrary.getSprite("flag_runner_5");x=new CToggle(CANVAS_WIDTH/2+180,CANVAS_HEIGHT/2-20,e,!0,s_oStage);x.addEventListenerWithParams(ON_MOUSE_UP,this._onModeToggle,
this,TEAM_5);e=s_oSpriteLibrary.getSprite("flag_runner_6");y=new CToggle(CANVAS_WIDTH/2+180,CANVAS_HEIGHT/2+60,e,!0,s_oStage);y.addEventListenerWithParams(ON_MOUSE_UP,this._onModeToggle,this,TEAM_6);e=s_oSpriteLibrary.getSprite("flag_runner_7");t=new CToggle(CANVAS_WIDTH/2+180,CANVAS_HEIGHT/2+145,e,!0,s_oStage);t.addEventListenerWithParams(ON_MOUSE_UP,this._onModeToggle,this,TEAM_7);this.refreshButtonPos(s_iOffsetX,s_iOffsetY)};this._onModeToggle=function(a){switch(a){case TEAM_0:D.setActive(!1);
B.setActive(!0);r.setActive(!0);u.setActive(!0);v.setActive(!0);x.setActive(!0);y.setActive(!0);t.setActive(!0);p=TEAM_0;k.refreshText(TEXT_TEAM_0);var b="runner_0";break;case TEAM_1:D.setActive(!0);B.setActive(!1);r.setActive(!0);u.setActive(!0);v.setActive(!0);x.setActive(!0);y.setActive(!0);t.setActive(!0);p=TEAM_1;k.refreshText(TEXT_TEAM_1);b="runner_1";break;case TEAM_2:D.setActive(!0);B.setActive(!0);r.setActive(!1);u.setActive(!0);v.setActive(!0);x.setActive(!0);y.setActive(!0);t.setActive(!0);
p=TEAM_2;k.refreshText(TEXT_TEAM_2);b="runner_2";break;case TEAM_3:D.setActive(!0);B.setActive(!0);r.setActive(!0);u.setActive(!1);v.setActive(!0);x.setActive(!0);y.setActive(!0);t.setActive(!0);p=TEAM_3;k.refreshText(TEXT_TEAM_3);b="runner_3";break;case TEAM_4:D.setActive(!0);B.setActive(!0);r.setActive(!0);u.setActive(!0);v.setActive(!1);x.setActive(!0);y.setActive(!0);t.setActive(!0);p=TEAM_4;k.refreshText(TEXT_TEAM_4);b="runner_4";break;case TEAM_5:D.setActive(!0);B.setActive(!0);r.setActive(!0);
u.setActive(!0);v.setActive(!0);x.setActive(!1);y.setActive(!0);t.setActive(!0);p=TEAM_5;k.refreshText(TEXT_TEAM_5);b="runner_5";break;case TEAM_6:D.setActive(!0);B.setActive(!0);r.setActive(!0);u.setActive(!0);v.setActive(!0);x.setActive(!0);y.setActive(!1);t.setActive(!0);p=TEAM_6;k.refreshText(TEXT_TEAM_6);b="runner_6";break;case TEAM_7:D.setActive(!0),B.setActive(!0),r.setActive(!0),u.setActive(!0),v.setActive(!0),x.setActive(!0),y.setActive(!0),t.setActive(!1),p=TEAM_7,k.refreshText(TEXT_TEAM_7),
b="runner_7"}this.showPlayerPose(PLAYER_X_POSITION_IN_SELECTION,PLAYER_Y_POSITION_IN_SELECTION,b);s_iTeamSelected=p;s_szTeamSelectedSprite=b};this.showPlayerPose=function(a,b,c){s_oStage.removeChild(e);c=s_oSpriteLibrary.getSprite(c+"_pose");e=createBitmap(c);e.x=a;e.y=b;e.regX=c.width/2;e.regY=c.height/2;s_oStage.addChild(e)};this._onExit=function(){s_oMain.gotoMenu();$(s_oMain).trigger("end_session")};this._onAudioToggle=function(){Howler.mute(s_bAudioActive);s_bAudioActive=!s_bAudioActive};this.unload=
function(){v.unload();t.unload();x.unload();r.unload();y.unload();u.unload();B.unload();D.unload();F&&screenfull.enabled&&E.unload();s_oSelectTeam=null;s_oStage.removeAllChildren()};this.refreshButtonPos=function(c,d){G.setPosition(g-c,d+l);!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||P.setPosition(f-c,d+n);F&&screenfull.enabled&&E.setPosition(b+c,a+d)};this._onButNextRelease=function(){this.unload();s_oMain.gotoSelectLevel()};this.resetFullscreenBut=function(){F&&screenfull.enabled&&E.setActive(s_bFullscreen)};
this._onFullscreen=function(){s_bFullscreen?I.call(window.document):F.call(window.document.documentElement);sizeHandler()};s_oSelectTeam=this;this._init()}var s_oSelectTeam=null;
function CGame(b,a){var c=0,d=0,f=s_iTeamSelected,n=0,g=!1,l=!1,p=!1,h=!1,e,k,w,v,t=null,r=null,u,x,y,B=[],D=[TEAM_0,TEAM_1,TEAM_2,TEAM_3,TEAM_4,TEAM_5,TEAM_6,TEAM_7],E=[{x:404,y:228},{x:452,y:255},{x:504,y:279},{x:556,y:304},{x:608,y:327},{x:657,y:353},{x:709,y:376},{x:758,y:402}],F=[{x:8106,y:-1640},{x:8154,y:-1616},{x:8202,y:-1592},{x:8250,y:-1568},{x:8298,y:-1544},{x:8346,y:-1520},{x:8394,y:-1496},{x:8442,y:-1472}],I=[],O=[],G=[];this._init=function(){$(s_oMain).trigger("start_level",a);playSound("crowd",
1,!0);setVolume("soundtrack",0);x=new createjs.Container;s_oStage.addChild(x);u=new CScrollingBg(x);u.setArrivalPositions(F);var b=D[f];D[f]=null;y=new createjs.Container;s_oStage.addChild(y);for(var c=0;c<NUM_RUNNERS;c++)if(3!==c){null!==D[c]?(G.push(D[c]),D[c]=null):c===NUM_RUNNERS-1?(G.push(D[3]),D[3]=null):(G.push(D[c+1]),D[c+1]=null);var d=ENEMY_MAX_SPEED[c]+s_iSpeedAdder,e=ENEMY_MIN_SPEED[c],l=ENEMY_ENERGY[c]+s_iEnergyAdder,g=ENEMY_RESISTENCE_STEP[c],h=ENEMY_OCCURRENCE_RUN[c];B.push(new CRunner(E[c].x,
E[c].y,y,c,!1,PLAYER_NAME_AND_SPRITE[G[G.length-1]],d,e,l,g,h))}else G.push(b),d=PLAYER_MAX_SPEED+s_iSpeedAdder,e=PLAYER_MIN_SPEED,l=PLAYER_ENERGY+s_iEnergyAdder,g=PLAYER_RESISTENCE_STEP,h=0,B.push(new CRunner(E[c].x,E[c].y,y,c,!0,PLAYER_NAME_AND_SPRITE[G[G.length-1]],d,e,l,g,h));k=new CInterface;w=new CHealthBar;DIST_FROM_ARRIVAL=30;s_bMobile?v=new CMobileControls:document.onkeydown=this.onKeyDown;this.enableMovement()};this.enableMovement=function(){for(var a=[],b=0;b<NUM_RUNNERS;b++)a.push(B[b].getInfos());
e=new CShowNationalityInLane(a,x);t=new CVariousHelp(TEXT_START_MOVEMENT,WAIT_FOR_GAME_START)};this.startGame=function(){if(g){l=!0;for(var a=0;a<NUM_RUNNERS;a++)B[a].playAnimation()}else g=!0,k.setGUIClickable(),setTimeout(function(){s_oGame.prepareRunners()},2E3)};this.prepareRunners=function(){playSound("prepare_runner",1,!1);for(var a=0;a<NUM_RUNNERS;a++)B[a].playAnimation();setTimeout(function(){s_oGame.startRunners()},1500)};this.startRunners=function(){playSound("start_race",1,!1);playSound("crowd_cheers",
1,!1);for(var a=0;a<NUM_RUNNERS;a++)B[a].changeAnimation(ANIMATION_STARTING);e&&(e.unload(),e=null);l=!0};this.onKeyDown=function(a){if(l)return a||(a=window.event),a.keyCode===LEFT_DIR?p=!0:a.keyCode===RIGHT_DIR&&(h=!0),p&&h&&B[3].addSpeed(),a.preventDefault(),!1};this.onButtonDown=function(a){null!==t&&(P.unloadVariousHelp(),e.unload(),e=null,g=!0,k.setGUIClickable());l&&(a===LEFT_DIR?p=!0:a===RIGHT_DIR&&(h=!0),p&&h&&B[3].addSpeed())};this.moveRunnersWithBG=function(a){u.move(a);for(var b=u.getDirectionVector(),
c=0;c<NUM_RUNNERS;c++)B[c].movementAffectedByPlayer(a,b)};this.moveEnemies=function(){for(var a=0;a<NUM_RUNNERS;a++)3!==a&&(!1===B[a].isArrived()&&Math.random()>B[a].getOccurrenceRun()*B[a].getEnergyProportion()&&B[a].addSpeed(),B[a].move()),B[a].decreaseSpeed(),B[a].increaseEnergy()};this.checkIfIsElapsedTooMuchTimeBetweenPress=function(){c+=s_iTimeElaps;200<c?c=0:p&&h&&(h=p=!1,c=0)};this.checkDistanceFromArrivalPoint=function(){for(var a=0;a<NUM_RUNNERS;a++)B[a].checkDistance(u.getArrivalPositions(a))};
this.addInArrayPlayerArrived=function(b,c){I.push({lane:b,name:c,time:formatTime(d)});1===I.length&&playSound("crowd_arrival",1,!1);var f=I.length-1;O.push({player:G[b],position:f});k.addArrivalPanel(I[f]);3===b&&3>=f+1?(n=f,s_oCityInfos.setRewardTaken(a,n)):3===b&&(n=f);3===b&&null!==s_oCityInfos.getTimeSpent(a)?s_oCityInfos.getTimeSpent(a)>d&&s_oCityInfos.setTimeSpent(a,d):3===b&&s_oCityInfos.setTimeSpent(a,d);I.length===NUM_RUNNERS&&(s_oCityInfos.setPlayersArrivals(a,O),setTimeout(this.gameOver(),
1E3))};this.changeBGsDirection=function(){u.changeDir()};this.unloadVariousHelp=function(a){t.unload();t=null;if(a===CONFIRMATION_ON_EXIT)for(l=g=!0,a=0;a<NUM_RUNNERS;a++)B[a].playAnimation();k.setGUIClickable()};this.unload=function(){s_bMobile?v.unload():document.onkeydown=null;stopSound("crowd");k.unload();createjs.Tween.removeAllTweens();s_oStage.removeAllChildren();setVolume("soundtrack",SOUNDTRACK_VOLUME_IN_GAME)};this.onInfo=function(){if(l){t=new CVariousHelp(TEXT_START_MOVEMENT,WAIT_FOR_GAME_START);
l=!1;for(var a=0;a<NUM_RUNNERS;a++)B[a].stopAnimation()}};this.onInfoExit=function(){t.unload();t=null;if(g){l=!0;for(var a=0;a<NUM_RUNNERS;a++)B[a].playAnimation()}};this.onExitMessage=function(){if(null===t&&l){t=new CVariousHelp(TEXT_ON_EXIT,CONFIRMATION_ON_EXIT);g=l=!1;for(var a=0;a<NUM_RUNNERS;a++)B[a].stopAnimation()}};this.onExit=function(){$(s_oMain).trigger("end_level");$(s_oMain).trigger("end_session");this.unload();s_oMain.gotoMenu();$(s_oMain).trigger("restart")};this.onContinue=function(){$(s_oMain).trigger("end_level");
$(s_oMain).trigger("show_interlevel_ad");this.unload();s_oMain.gotoPlayerProgress()};this.gameOver=function(){3>n&&s_iLevelReached<a+2&&(s_iLevelReached=a+2);setTimeout(function(){v&&v.hideButtons();k.unloadArrivalPanel();g=l=!1;for(var a=0;a<NUM_RUNNERS;a++)B[a].stopAnimation()},500);a<s_oCityInfos.getNumLevels()-1?r=CEndPanel(I,a):(setVolume("soundtrack",SOUNDTRACK_VOLUME_IN_GAME),r=new CPodiumScreen(a));r.show()};this.update=function(){if(l){if(!1===B[3].isArrived()){var a=B[3].getSpeed();this.moveRunnersWithBG(a)}else B[3].move();
d+=s_iTimeElaps;k.refreshTime(formatTime(d));this.moveEnemies();w.refreshMask(B[3].getEnergy());this.checkIfIsElapsedTooMuchTimeBetweenPress();this.checkDistanceFromArrivalPoint()}};PLAYER_MAX_SPEED=b.player_max_speed;PLAYER_MIN_SPEED=b.player_min_speed;PLAYER_ENERGY=b.player_energy;PLAYER_RESISTENCE_STEP=b.player_resistence_step;PLAYER_MAX_SPEED_ADDER=b.player_max_speed_adder;PLAYER_ENERGY_ADDER=b.player_energy_adder;PLAYER_NAME_AND_SPRITE=[{name:TEXT_TEAM_0,sprite:0},{name:TEXT_TEAM_1,sprite:1},
{name:TEXT_TEAM_2,sprite:2},{name:TEXT_TEAM_3,sprite:3},{name:TEXT_TEAM_4,sprite:4},{name:TEXT_TEAM_5,sprite:5},{name:TEXT_TEAM_6,sprite:6},{name:TEXT_TEAM_7,sprite:7}];s_oGame=this;var P=this;this._init()}var s_oGame;
function CInterface(){var b,a,c,d,f,n,g,l,p,h,e,k,w=null,v=null,t=[],r,u=0,x=!1,y,B;this._init=function(){var u,x=s_oSpriteLibrary.getSprite("but_exit");g=CANVAS_WIDTH-x.width/2-10;l=x.height/2+10;h=new CGfxButton(g,l,x,s_oStage);h.addEventListener(ON_MOUSE_UP,this._onExit,this);x=s_oSpriteLibrary.getSprite("but_info");f=CANVAS_WIDTH-x.width/2-90;n=x.height/2+10;e=new CGfxButton(f,n,x,s_oStage);e.addEventListener(ON_MOUSE_UP,this._onInfo,this);c=u=CANVAS_WIDTH-x.width/2-170;d=x.height/2+10;!1===DISABLE_SOUND_MOBILE||
!1===s_bMobile?(x=s_oSpriteLibrary.getSprite("audio_icon"),p=new CToggle(c,d,x,s_bAudioActive,s_oStage),p.addEventListener(ON_MOUSE_UP,this._onAudioToggle,this),x=s_oSpriteLibrary.getSprite("but_fullscreen"),b=c-x.width/2-10):(x=s_oSpriteLibrary.getSprite("but_fullscreen"),b=u);a=x.height/2+10;u=window.document;var F=u.documentElement;w=F.requestFullscreen||F.mozRequestFullScreen||F.webkitRequestFullScreen||F.msRequestFullscreen;v=u.exitFullscreen||u.mozCancelFullScreen||u.webkitExitFullscreen||u.msExitFullscreen;
!1===ENABLE_FULLSCREEN&&(w=!1);w&&screenfull.enabled&&(k=new CToggle(b,a,x,s_bFullscreen,s_oStage),k.addEventListener(ON_MOUSE_UP,this._onFullscreen,this));y=new createjs.Container;y.x=10;y.y=15;s_oStage.addChild(y);x=createBitmap(s_oSpriteLibrary.getSprite("time_panel"));y.addChild(x);B=new CTLText(y,10,12,225,40,40,"center","#fff",FONT_2,1.2,0,0,"00:00:000",!0,!0,!1,!1);r=[{x:CANVAS_WIDTH-250,y:100},{x:CANVAS_WIDTH-250,y:150},{x:CANVAS_WIDTH-250,y:200},{x:CANVAS_WIDTH-250,y:250},{x:CANVAS_WIDTH-
250,y:300},{x:CANVAS_WIDTH-250,y:350},{x:CANVAS_WIDTH-250,y:400},{x:CANVAS_WIDTH-250,y:450}];for(x=0;x<NUM_RUNNERS;x++)t.push(new CArrivalPanel(CANVAS_WIDTH,r[x].y,s_oStage));this.refreshButtonPos(s_iOffsetX,s_iOffsetY)};this.addArrivalPanel=function(a){t[u].show(CANVAS_WIDTH-s_iOffsetX-250,a,u+1);u++};this.unloadArrivalPanel=function(){for(var a=0;a<t.length;a++)t[a].hide(CANVAS_WIDTH+250)};this.refreshTime=function(a){B.refreshText(a)};this.unload=function(){if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)p.unload(),
p=null;w&&screenfull.enabled&&k.unload();h.unload();e.unload();s_oInterface=null};this.refreshButtonPos=function(v,r){h.setPosition(g-v,r+l);e.setPosition(f-v,r+n);!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||p.setPosition(c-v,r+d);w&&screenfull.enabled&&k.setPosition(b-v,a+r);y.x=10+v;y.y=15+r;for(var u=0;u<NUM_RUNNERS;u++)t[u].refreshButtonPos(v,r)};this.setGUIClickable=function(){x=!0};this._onButRestartRelease=function(){s_oGame.restartGame()};this.onExitFromHelp=function(){_oHelpPanel.unload()};
this._onAudioToggle=function(){x?(Howler.mute(s_bAudioActive),s_bAudioActive=!s_bAudioActive):p.setActive(!0)};this._onInfo=function(){if(x)s_oGame.onInfo()};this._onExit=function(){if(x)s_oGame.onExitMessage()};this.resetFullscreenBut=function(){w&&screenfull.enabled&&k.setActive(s_bFullscreen)};this._onFullscreen=function(){s_bFullscreen?v.call(window.document):w.call(window.document.documentElement);sizeHandler()};s_oInterface=this;this._init();return this}var s_oInterface=null;
function CEndPanel(b,a){var c,d,f=0,n,g,l,p,h,e=s_oCityInfos.getPlayersArrivals(),k=[],w=[100,50,25,10,9,8,7,6];this._init=function(){l=new createjs.Container;l.alpha=0;l.visible=!1;s_oStage.addChild(l);h=new createjs.Shape;h.graphics.beginFill("rgba(0,0,0,0.6)").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);h.on("click",function(){});l.addChild(h);var a=s_oSpriteLibrary.getSprite("result_panel");g=createBitmap(a);g.x=CANVAS_WIDTH/2;g.y=CANVAS_HEIGHT/2;g.regX=a.width/2;g.regY=a.height/2;l.addChild(g);
new CTLText(l,500,145,200,20,20,"left","#fff",FONT,1,0,0,TEXT_DISCIPLINE,!0,!0,!1,!1);new CTLText(l,500,170,200,30,30,"left","#fff",FONT,1,0,0,TEXT_RESULT,!0,!0,!1,!1);a=s_oSpriteLibrary.getSprite("but_continue_small");c=CANVAS_WIDTH/2+340;d=CANVAS_HEIGHT-172;p=new CGfxButton(c,d,a,l);p.addEventListener(ON_MOUSE_UP,this._onContinue,this);this.getRunnerInLane();this.addScoreToPlayers()};this.show=function(){for(var c=450,d=210,g=0;g<e[a].length;g++){var h=createBitmap(s_oSpriteLibrary.getSprite("flag_"+
e[a][g].player));h.x=c;h.y=d;l.addChild(h);c+=110;new CTLText(l,c-155,d,30,20,30,"left","#fff",FONT,1,0,0,g+1,!0,!0,!1,!1);new CTLText(l,c,d,200,20,20,"left","#fff",FONT,1,0,0,b[g].name,!0,!0,!1,!1);c+=305;new CTLText(l,c,d,100,20,20,"left","#fff",FONT,1,0,0,b[g].time,!0,!0,!1,!1);c=450;d+=37}l.visible=!0;createjs.Tween.get(l).to({alpha:1},500).call(function(){});$(s_oMain).trigger("save_score",f);saveItem("100metres_LevelReached",s_iLevelReached);saveItem("100metres_Money",s_iPlayerMoney);saveItem("100metres_SpeedBought",
s_iSpeedBought);saveItem("100metres_EnergyBought",s_iEnergyBought);saveItem("100metres_SpeedAdder",s_iSpeedAdder);saveItem("100metres_EnergyAdder",s_iEnergyAdder);saveItem("100metres_TeamSelected",s_iTeamSelected);saveItem("100metres_TeamSelectedSprite",s_szTeamSelectedSprite);saveItem("100metres_Scores",JSON.stringify(s_aRunnersScore));s_oCityInfos.addCitiesStorage()};this.getRunnerInLane=function(){for(var b=0;b<e[0].length;b++)k.push(PLAYER_NAME_AND_SPRITE[e[a][b].player].sprite),k[b]===s_iTeamSelected&&
(n=b)};this.addScoreToPlayers=function(){for(var b=0;b<e[a].length;b++)s_aRunnersScore[e[a][b].player]+=w[e[a][b].position];f=s_aRunnersScore[e[a][n].player]};this._onContinue=function(){playSound("click",.5,!1);s_oStage.removeChild(l);p.unload();h.off("click",function(){});s_oGame.onContinue()};this._init();return this}
function CRunner(b,a,c,d,f,n,g,l,p,h,e){var k=!1,w=0,v=0,t=p,r=t,u=n.name,x=n.sprite,y,B=null,D=new CVector2(0,1),E=new CVector2;this._init=function(){this.createRunner()};this.createRunner=function(){var d={images:[s_oSpriteLibrary.getSprite("runner_"+x)],framerate:15,frames:{width:PLAYER_WIDTH,height:PLAYER_HEIGHT,regX:PLAYER_WIDTH/2,regY:PLAYER_HEIGHT/2},animations:{position:[0,10,!1],starting:[11,39,!1],run:[40,45,"run"],ending:[46,56]}};d=new createjs.SpriteSheet(d);y=new createjs.Sprite(d,"position");
y.addEventListener("animationend",this._onAnimationEnd);y.x=b;y.y=a;y.currentAnimationFrame=0;c.addChild(y);v=ANIMATION_POSITION;y.stop();rotateVector2D(Math.PI/180*104,D);f&&(B=createBitmap(s_oSpriteLibrary.getSprite("arrow_bar")),B.x=y.x+40,B.y=y.y-60,B.scaleX=.4,B.scaleY=.4,s_oStage.addChild(B),this._cursorAnimationDown())};this.stopAnimation=function(){y.stop()};this.playAnimation=function(){y.play()};this.changeAnimation=function(a){y.gotoAndPlay(a);v=a;v===ANIMATION_STARTING&&f&&(this._stopCursorAnim(),
a=y.y-80,createjs.Tween.get(B).to({y:a},500).call(function(){F._cursorAnimationDown()}))};this.checkDistance=function(a){this.distance2(E,a)/100<DIST_FROM_ARRIVAL&&v===ANIMATION_RUNNING&&!1===k&&(k=!0,this.changeAnimation(ANIMATION_ENDING),s_oGame.addInArrayPlayerArrived(d,u),null!==B&&(createjs.Tween.removeTweens(B),s_oStage.removeChild(B)))};this._onAnimationEnd=function(){v===ANIMATION_STARTING&&F.showRunningAnimation()};this.showRunningAnimation=function(){v=ANIMATION_RUNNING;y.gotoAndPlay(ANIMATION_RUNNING);
f&&E.set(y.x,y.y)};this._stopCursorAnim=function(){createjs.Tween.removeTweens(B)};this._cursorAnimationDown=function(){createjs.Tween.get(B).to({y:B.y+10},500).call(function(){F._cursorAnimationUp()})};this._cursorAnimationUp=function(){createjs.Tween.get(B).to({y:B.y-10},500).call(function(){F._cursorAnimationDown()})};this.distance2=function(a,b){return(b.getX()-a.getX())*(b.getX()-a.getX())+(b.getY()-a.getY())*(b.getY()-a.getY())};this.move=function(){y.x+=w*D.getX();y.y+=w*D.getY();E.set(y.x,
y.y)};this.movementAffectedByPlayer=function(a,b){f||(y.x+=a*b.getX(),y.y+=a*b.getY())};this.addSpeed=function(){if(0<=t){t-=h;var a=t/r*MODIFIER_SPEED_ADDER;a<h&&(a=h);w+=a;w>=g?w=g:w<=l&&(w=l)}};this.changeDirection=function(){rotateVector2D(Math.PI/180*180,D)};this.decreaseSpeed=function(){w-=SPEED_DECELERATION;w<=l&&(w=l)};this.increaseEnergy=function(){t<r&&(t+=ENERGY_INCREASE)};this.getEnergyProportion=function(){return t/r};this.getOccurrenceRun=function(){return e};this.getInfos=function(){return{sprite:x,
nationality:u}};this.getSpeed=function(){return w};this.isArrived=function(){return k};this.getEnergy=function(){return t};this.unload=function(){y=null;c.removeAllChildren()};var F=this;this._init()}
function CScrollingBg(b){var a=[],c,d=new CVector2(0,1);this._init=function(){var c=s_oSpriteLibrary.getSprite("track_0");a[0]=createBitmap(c);a[0].scaleX=a[0].scaleY=s_iScale;b.addChild(a[0]);c=s_oSpriteLibrary.getSprite("track_1");a[1]=createBitmap(c);a[1].y=-CANVAS_HEIGHT;a[1].scaleX=a[1].scaleY=s_iScale;b.addChild(a[1]);c=s_oSpriteLibrary.getSprite("track_2");a[2]=createBitmap(c);a[2].x=CANVAS_WIDTH;a[2].scaleX=a[2].scaleY=s_iScale;b.addChild(a[2]);c=s_oSpriteLibrary.getSprite("track_3");a[3]=
createBitmap(c);a[3].x=CANVAS_WIDTH;a[3].y=-CANVAS_HEIGHT;a[3].scaleX=a[3].scaleY=s_iScale;b.addChild(a[3]);c=s_oSpriteLibrary.getSprite("track_4");a[4]=createBitmap(c);a[4].x=2*CANVAS_WIDTH;a[4].scaleX=a[4].scaleY=s_iScale;b.addChild(a[4]);c=s_oSpriteLibrary.getSprite("track_5");a[5]=createBitmap(c);a[5].x=2*CANVAS_WIDTH;a[5].y=-CANVAS_HEIGHT;a[5].scaleX=a[5].scaleY=s_iScale;b.addChild(a[5]);c=s_oSpriteLibrary.getSprite("track_6");a[6]=createBitmap(c);a[6].x=2*CANVAS_WIDTH;a[6].y=2*-CANVAS_HEIGHT;
a[6].scaleX=a[6].scaleY=s_iScale;b.addChild(a[6]);c=s_oSpriteLibrary.getSprite("track_7");a[7]=createBitmap(c);a[7].x=3*CANVAS_WIDTH;a[7].y=-CANVAS_HEIGHT;a[7].scaleX=a[7].scaleY=s_iScale;b.addChild(a[7]);c=s_oSpriteLibrary.getSprite("track_8");a[8]=createBitmap(c);a[8].x=3*CANVAS_WIDTH;a[8].y=2*-CANVAS_HEIGHT;a[8].scaleX=a[8].scaleY=s_iScale;b.addChild(a[8]);c=s_oSpriteLibrary.getSprite("track_9");a[9]=createBitmap(c);a[9].x=4*CANVAS_WIDTH;a[9].y=-CANVAS_HEIGHT;a[9].scaleX=a[9].scaleY=s_iScale;b.addChild(a[9]);
c=s_oSpriteLibrary.getSprite("track_10");a[10]=createBitmap(c);a[10].x=4*CANVAS_WIDTH;a[10].y=2*-CANVAS_HEIGHT;a[10].scaleX=a[10].scaleY=s_iScale;b.addChild(a[10]);c=s_oSpriteLibrary.getSprite("track_11");a[11]=createBitmap(c);a[11].x=4*CANVAS_WIDTH;a[11].y=3*-CANVAS_HEIGHT;a[11].scaleX=a[11].scaleY=s_iScale;b.addChild(a[11]);c=s_oSpriteLibrary.getSprite("track_12");a[12]=createBitmap(c);a[12].x=5*CANVAS_WIDTH;a[12].y=2*-CANVAS_HEIGHT;a[12].scaleX=a[12].scaleY=s_iScale;b.addChild(a[12]);c=s_oSpriteLibrary.getSprite("track_13");
a[13]=createBitmap(c);a[13].x=5*CANVAS_WIDTH;a[13].y=3*-CANVAS_HEIGHT;a[13].scaleX=a[13].scaleY=s_iScale;b.addChild(a[13]);c=s_oSpriteLibrary.getSprite("track_14");a[14]=createBitmap(c);a[14].x=5*CANVAS_WIDTH;a[14].y=4*-CANVAS_HEIGHT;a[14].scaleX=a[14].scaleY=s_iScale;b.addChild(a[14]);c=s_oSpriteLibrary.getSprite("track_15");a[15]=createBitmap(c);a[15].x=6*CANVAS_WIDTH;a[15].y=2*-CANVAS_HEIGHT;a[15].scaleX=a[15].scaleY=s_iScale;b.addChild(a[15]);c=s_oSpriteLibrary.getSprite("track_16");a[16]=createBitmap(c);
a[16].x=6*CANVAS_WIDTH;a[16].y=3*-CANVAS_HEIGHT;a[16].scaleX=a[16].scaleY=s_iScale;b.addChild(a[16]);c=s_oSpriteLibrary.getSprite("track_17");a[17]=createBitmap(c);a[17].x=6*CANVAS_WIDTH;a[17].y=4*-CANVAS_HEIGHT;a[17].scaleX=a[17].scaleY=s_iScale;b.addChild(a[17]);rotateVector2D(Math.PI/180*-76,d)};this.setArrivalPositions=function(a){c=a};this.changeDir=function(){rotateVector2D(Math.PI/180*180,d)};this.move=function(a){b.x+=a*d.getX();b.y+=a*d.getY();for(var f=0;f<c.length;f++)c[f].x+=a*d.getX(),
c[f].y+=a*d.getY()};this.getArrivalPositions=function(a){return new CVector2(c[a].x,c[a].y)};this.getDirectionVector=function(){return d};this._init()}
function CHealthBar(){var b,a,c=100,d,f,n,g=CANVAS_WIDTH/2+170,l=CANVAS_HEIGHT-110,p=g-4,h=l+30;this.init=function(){var c=s_oSpriteLibrary.getSprite("health");f=createBitmap(c);f.x=p;f.y=h;f.regX=c.width;f.alpha=.9;s_oStage.addChild(f);b=c.width;a=c.height-6;n=new createjs.Shape;n.graphics.beginFill("rgba(0,255,255,1)").drawRect(f.x-b,f.y,b,a+3);s_oStage.addChild(n);c=s_oSpriteLibrary.getSprite("energy_bar");d=createBitmap(c);d.x=g;d.y=l;d.regX=c.width;s_oStage.addChild(d);f.mask=n;this.refreshButtonPos(s_iOffsetX,
s_iOffsetY)};this.refreshMask=function(d){c=d;n.graphics.clear();d=Math.floor(c*b/100);n.graphics.beginFill("rgba(0,255,255,0.01)").drawRect(f.x-b,f.y+3,d,a)};this.refreshButtonPos=function(a,b){f.y=h-b;d.y=l-b;this.refreshMask(c)};s_oHealthBar=this;this.init()}var s_oHealthBar=null;
function CMobileControls(){var b=CANVAS_HEIGHT-150,a,c=CANVAS_WIDTH-100,d=CANVAS_HEIGHT-150,f;this.init=function(){var n=s_oSpriteLibrary.getSprite("left_button");a=new CGfxButton(100,b,n,s_oStage);a.addEventListenerWithParams(ON_MOUSE_DOWN,s_oGame.onButtonDown,this,LEFT_DIR);n=s_oSpriteLibrary.getSprite("right_button");f=new CGfxButton(c,d,n,s_oStage);f.addEventListenerWithParams(ON_MOUSE_DOWN,s_oGame.onButtonDown,this,RIGHT_DIR);this.refreshButtonPos(s_iOffsetX,s_iOffsetY)};this.spawnButtonForBar=
function(){a.setVisible(!1);f.setVisible(!1)};this.hideButtonForBar=function(){a.setVisible(!0);f.setVisible(!0)};this.hideButtons=function(){a.setVisible(!1);f.setVisible(!1)};this.refreshButtonPos=function(n,g){a.setPosition(100+n,b);f.setPosition(c-n,d)};this.unload=function(){a.unload();f.unload()};s_oMobileControls=this;this.init()}var s_oMobileControls=null;
function CLevelMenu(){var b,a,c,d,f,n,g=[],l,p=null,h=null,e,k,w;this._init=function(){e=createBitmap(s_oSpriteLibrary.getSprite("bg_select_challenge"));s_oStage.addChild(e);var v=new createjs.Shape;v.graphics.beginFill("rgba(0,0,0,0.6)").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);s_oStage.addChild(v);v=s_oSpriteLibrary.getSprite("select_challenge");e=createBitmap(v);e.x=CANVAS_WIDTH/2;e.y=CANVAS_HEIGHT/2;e.regX=v.width/2;e.regY=v.height/2;s_oStage.addChild(e);new CTLText(s_oStage,CANVAS_WIDTH/2-190,
108,400,24,24,"left","#fff",FONT,1,0,0,TEXT_CHALLENGE,!0,!0,!1,!1);v=CANVAS_WIDTH/2-240;for(var t=0,r=50,u=0;u<s_oCityInfos.getNumLevels();u++,t+=120){500<t&&(t=0,r+=175);var x=s_oCityInfos.getCityName(u),y=s_oCityInfos.getRewards(u);u<s_iLevelReached?g.push(new CLevelBut(v+t,215+r,s_oSpriteLibrary.getSprite("level_sprite"),!0,u+1,x,y)):g.push(new CLevelBut(v+t,215+r,s_oSpriteLibrary.getSprite("level_sprite"),!1,u+1,x,y));g[u].addEventListenerWithParams(ON_MOUSE_UP,this._onClick,this,u);g[u].addEventListenerWithParams(ON_MOUSE_DOWN,
this._onMouseDown,this,u);s_bFirstTime=!0}v=s_oSpriteLibrary.getSprite("but_exit");f=CANVAS_WIDTH-v.height/2-10;n=v.height/2+10;k=new CGfxButton(f,n,v,s_oStage);k.addEventListener(ON_MOUSE_UP,this._onExit,this);c=CANVAS_WIDTH-v.width/2-90;d=v.height/2+10;if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)v=s_oSpriteLibrary.getSprite("audio_icon"),w=new CToggle(c,d,v,s_bAudioActive,s_oStage),w.addEventListener(ON_MOUSE_UP,this._onAudioToggle,this);v=window.document;t=v.documentElement;p=t.requestFullscreen||
t.mozRequestFullScreen||t.webkitRequestFullScreen||t.msRequestFullscreen;h=v.exitFullscreen||v.mozCancelFullScreen||v.webkitExitFullscreen||v.msExitFullscreen;!1===ENABLE_FULLSCREEN&&(p=!1);p&&screenfull.enabled&&(v=s_oSpriteLibrary.getSprite("but_fullscreen"),b=v.width/4+10,a=v.height/2+10,l=new CToggle(b,a,v,s_bFullscreen,s_oStage),l.addEventListener(ON_MOUSE_UP,this._onFullscreen,this));this.refreshButtonPos(s_iOffsetX,s_iOffsetY)};this.unload=function(){for(var a=0;a<s_oCityInfos.getNumLevels();a++)g[a].unload();
p&&screenfull.enabled&&l.unload();s_oLevelMenu=null;s_oStage.removeAllChildren()};this.refreshButtonPos=function(e,g){k.setPosition(f-e,g+n);!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||w.setPosition(c-e,g+d);p&&screenfull.enabled&&l.setPosition(b+e,a+g)};this._onNumModeToggle=function(a){a===NUM_ACTIVE?((void 0).setActive(!1),(void 0).setActive(!0)):((void 0).setActive(!0),(void 0).setActive(!1))};this._onAudioToggle=function(){Howler.mute(s_bAudioActive);s_bAudioActive=!s_bAudioActive};this._onMouseDown=
function(a){g[a].scaleText()};this._onClick=function(a){playSound("click",1,!1);g[a].ifClickable()&&(s_oLevelMenu.unload(),s_oMain.gotoGame(a))};this._onExit=function(){s_oLevelMenu.unload();1===s_iLevelReached?(s_oMain.gotoMenu(),$(s_oMain).trigger("end_session")):s_oMain.gotoPlayerProgress()};this.resetFullscreenBut=function(){p&&screenfull.enabled&&l.setActive(s_bFullscreen)};this._onFullscreen=function(){s_bFullscreen?h.call(window.document):p.call(window.document.documentElement);sizeHandler()};
s_oLevelMenu=this;this._init()}var s_oLevelMenu=null;
function CLevelBut(b,a,c,d,f,n,g){var l,p,h,e=[],k=[],w,v,t;this._init=function(a,b,c,d){p=[];h=[];t=new createjs.Container;t.x=a;t.y=b;s_oStage.addChild(t);var f=new createjs.SpriteSheet({images:[c],frames:{width:c.width/2,height:c.height,regX:c.width/2/2,regY:c.height/2},animations:{state_true:[0],state_false:[1]}});l=d;w=createSprite(f,"state_"+l,c.width/2/2,c.height/2,c.width/2,c.height);w.mouseEnabled=d;w.x=0;w.y=0;w.cursor="pointer";w.stop();t.addChild(w);e.push(w);new CTLText(s_oStage,a-50,
b-82,100,14,14,"center","#fff",FONT,1,0,0,n,!0,!0,!1,!1);v=new CTLText(t,-10,-46,45,20,20,"left","#fff",FONT,1,0,0,g.first+TEXT_CURRENCY,!0,!0,!1,!1);new CTLText(t,-10,v.getY()+37,45,20,20,"left","#fff",FONT,1,0,0,g.second+TEXT_CURRENCY,!0,!0,!1,!1);new CTLText(t,-10,v.getY()+73,45,20,20,"left","#fff",FONT,1,0,0,g.third+TEXT_CURRENCY,!0,!0,!1,!1);this._initListener()};this.scaleText=function(){t.scaleY=.9};this.unload=function(){w.off("mousedown",this.buttonDown);w.off("pressup",this.buttonRelease);
s_oStage.removeChild(w)};this._initListener=function(){w.on("mousedown",this.buttonDown);w.on("pressup",this.buttonRelease)};this.viewBut=function(a){s_oStage.addChild(a)};this.addEventListener=function(a,b,c){p[a]=b;h[a]=c};this.addEventListenerWithParams=function(a,b,c,d){p[a]=b;h[a]=c;k=d};this.ifClickable=function(){return!0===w.mouseEnabled?1:0};this.setActive=function(a,b){l=b;e[a].gotoAndStop("state_"+l);e[a].mouseEnabled=!0};this.buttonRelease=function(){t.scaleX=1;t.scaleY=1;playSound("click",
1,!1);l=!l;w.gotoAndStop("state_"+l);p[ON_MOUSE_UP]&&p[ON_MOUSE_UP].call(h[ON_MOUSE_UP],k)};this.buttonDown=function(){t.scaleX=.9;t.scaleY=.9;p[ON_MOUSE_DOWN]&&p[ON_MOUSE_DOWN].call(h[ON_MOUSE_DOWN],k)};this.setPosition=function(a,b){w.x=a;w.y=b};this.setVisible=function(a){w.visible=a};this._init(b,a,c,d)}
function CCitySettings(){var b=[],a=[],c=[],d=[],f=[],n=[],g=[];this._init=function(){this.initCityName();this.initRewards();this.initRewardTaken();this.initTimeSpent();this.initRewardEarned();this.initValueToAddInEachLevelToCPU();this.initArrivalsPosition()};this.initCityName=function(){for(var a=0;10>a;a++)b.push(CITY_NAME[a])};this.initRewards=function(){a.push({first:100,second:50,third:25});a.push({first:100,second:50,third:25});a.push({first:100,second:50,third:25});a.push({first:100,second:50,
third:25});a.push({first:100,second:50,third:25});a.push({first:100,second:50,third:25});a.push({first:100,second:50,third:25});a.push({first:100,second:50,third:25});a.push({first:125,second:75,third:50});a.push({first:150,second:100,third:75})};this.initRewardTaken=function(){c.push(!1);c.push(!1);c.push(!1);c.push(!1);c.push(!1);c.push(!1);c.push(!1);c.push(!1);c.push(!1);c.push(!1)};this.initTimeSpent=function(){d.push(null);d.push(null);d.push(null);d.push(null);d.push(null);d.push(null);d.push(null);
d.push(null);d.push(null);d.push(null)};this.initRewardEarned=function(){f.push(null);f.push(null);f.push(null);f.push(null);f.push(null);f.push(null);f.push(null);f.push(null);f.push(null);f.push(null)};this.initValueToAddInEachLevelToCPU=function(){n.push({speed:0,energy:0});n.push({speed:.2,energy:2});n.push({speed:.4,energy:4});n.push({speed:.6,energy:6});n.push({speed:.8,energy:8});n.push({speed:1,energy:10});n.push({speed:1.2,energy:12});n.push({speed:1.4,energy:14});n.push({speed:1.6,energy:16});
n.push({speed:1.8,energy:18})};this.initArrivalsPosition=function(){g.push([{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},{player:0,position:-1}]);g.push([{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},{player:0,position:-1}]);g.push([{player:0,position:-1},{player:0,position:-1},
{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},{player:0,position:-1}]);g.push([{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},{player:0,position:-1}]);g.push([{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},
{player:0,position:-1}]);g.push([{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},{player:0,position:-1}]);g.push([{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},{player:0,position:-1}]);g.push([{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},
{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},{player:0,position:-1}]);g.push([{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},{player:0,position:-1}]);g.push([{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},{player:0,position:-1},{player:0,position:-1}])};this.addCitiesStorage=
function(){saveItem("100metres_RewardTaken",JSON.stringify(c));saveItem("100metres_TimeSpent",JSON.stringify(d));saveItem("100metres_RewardEarned",JSON.stringify(f));saveItem("100metres_ArrivalsPosition",JSON.stringify(g))};this.removeCitiesStorage=function(){c=[];d=[];f=[];g=[];this.initRewardTaken();this.initTimeSpent();this.initRewardEarned();this.initArrivalsPosition();removeItem("100metres_RewardTaken");removeItem("100metres_TimeSpent");removeItem("100metres_RewardEarned");removeItem("100metres_ArrivalsPosition")};
this.getCitiesStorage=function(){c=JSON.parse(getItem("100metres_RewardTaken"));d=JSON.parse(getItem("100metres_TimeSpent"));f=JSON.parse(getItem("100metres_RewardEarned"));g=JSON.parse(getItem("100metres_ArrivalsPosition"))};this.getLevel=function(a){return a};this.getNumLevels=function(){return b.length};this.getCityName=function(a){return b[a]};this.getRewards=function(b){return a[b]};this.getValuesToAdd=function(a){return n[a]};this.setRewardTaken=function(b,d){if(!c[b]){c[b]=!0;switch(d){case 0:f[b]=
a[b].first;break;case 1:f[b]=a[b].second;break;case 2:f[b]=a[b].third}s_iPlayerMoney+=f[b]}};this.setPlayersArrivals=function(a,b){g[a]=b};this.getPlayersArrivals=function(){return g};this.getRewardTaken=function(a){return c[a]?f[a]:0};this.getMedal=function(b){return f[b]===a[b].first?"gold":f[b]===a[b].second?"silver":f[b]===a[b].third?"bronze":null};this.setTimeSpent=function(a,b){d[a]=b};this.getTimeSpent=function(a){return d[a]};this.unload=function(){b=[];a=[];c=[];d=[];f=[];n=[];g=[]};this._init()}
function CShowNationalityInLane(b,a){var c,d=[{x:446,y:228},{x:496,y:252},{x:547,y:276},{x:598,y:300},{x:649,y:324},{x:700,y:348},{x:751,y:372},{x:804,y:396}],f;this._init=function(){c=new createjs.Container;n.addChild(c);for(var a=0;a<b.length;a++){var l=s_oSpriteLibrary.getSprite("flag_runner_"+b[a].sprite+"_game");f=createBitmap(l);f.x=d[a].x;f.y=d[a].y;c.addChild(f)}};this._onButNextRelease=function(){s_oGame.enableMovement();this.unload()};this.unload=function(){createjs.Tween.get(c).to({alpha:0},
500).call(function(){n.removeChild(c)})};s_oShowLevelInfos=this;var n=a;this._init()}var s_oShowLevelInfos=null;
function CPlayerProgress(){var b,a,c,d,f,n,g,l,p=[100,150,200,250],h=[50,75,100,125],e,k=[],w=[],v=CANVAS_WIDTH/2-135,t=175,r,u=[],x=[],y=CANVAS_WIDTH/2+165,B=175,D=s_iPlayerMoney,E,F,I,O,G=CANVAS_WIDTH/2-200,P=222,Q=CANVAS_WIDTH/2-120,N=222,U=CANVAS_WIDTH/2-280,T=220,V=CANVAS_WIDTH/2+180,S=224,J,R,m,M,K=null,L=null;this._init=function(){var z=createBitmap(s_oSpriteLibrary.getSprite("bg_select_team"));s_oStage.addChild(z);z=new createjs.Shape;z.graphics.beginFill("rgba(0,0,0,0.6)").drawRect(0,0,CANVAS_WIDTH,
CANVAS_HEIGHT);s_oStage.addChild(z);z=s_oSpriteLibrary.getSprite("upgrade_panel");var q=createBitmap(z);q.x=CANVAS_WIDTH/2;q.y=CANVAS_HEIGHT/2;q.regX=z.width/2;q.regY=z.height/2;s_oStage.addChild(q);new CTLText(s_oStage,CANVAS_WIDTH/2-190,58,300,24,24,"left","#fff",FONT,1,0,0,TEXT_UPGRADE,!0,!0,!1,!1);e=new createjs.Shape;e.graphics.beginFill("#000000").drawRect(v-165,t-60,285,90);e.alpha=.01;e.on("mousedown",this.tryingToBuySpeed);e.cursor="pointer";s_oStage.addChild(e);r=new createjs.Shape;r.graphics.beginFill("#000000").drawRect(y-
160,B-60,285,90);r.alpha=.01;r.on("mousedown",this.tryingToBuyEnergy);r.cursor="pointer";s_oStage.addChild(r);new CTLText(s_oStage,CANVAS_WIDTH/2-290,145,70,40,20,"center","#fff",FONT,1,0,0,TEXT_BUY,!0,!0,!0,!1);new CTLText(s_oStage,CANVAS_WIDTH/2+15,145,70,40,20,"center","#fff",FONT,1,0,0,TEXT_BUY,!0,!0,!0,!1);for(q=0;q<NUM_POWER_UP_AVAILABLE;q++)k.push(createBitmap(s_oSpriteLibrary.getSprite("bar-1"))),k[q].x=v,k[q].y=t,s_oStage.addChild(k[q]),w.push(createBitmap(s_oSpriteLibrary.getSprite("bar-2"))),
w[q].x=v,w[q].y=t,w[q].visible=!1,s_oStage.addChild(w[q]),new CTLText(s_oStage,v+1,t+2,100,12,12,"center","#fff",FONT,1,0,0,p[q]+TEXT_CURRENCY,!0,!0,!1,!1),u.push(createBitmap(s_oSpriteLibrary.getSprite("bar-1"))),u[q].x=y,u[q].y=B,s_oStage.addChild(u[q]),x.push(createBitmap(s_oSpriteLibrary.getSprite("bar-2"))),x[q].x=y,x[q].y=B,x[q].visible=!1,s_oStage.addChild(x[q]),new CTLText(s_oStage,y+1,B+2,100,12,12,"center","#fff",FONT,1,0,0,h[q]+TEXT_CURRENCY,!0,!0,!1,!1),t-=15,B-=15;for(q=0;q<s_iSpeedBought;q++)this.makeVisibleSpeedBought(q);
for(q=0;q<s_iEnergyBought;q++)this.makeVisibleEnergyBought(q);O=new CTLText(s_oStage,CANVAS_WIDTH/2-190,90,200,20,20,"left","#fff",FONT,1,0,0,TEXT_MONEY+": "+D+TEXT_CURRENCY,!0,!0,!1,!1);for(q=0;q<s_oCityInfos.getNumLevels();q++)E=s_oCityInfos.getCityName(q),F=formatTime(s_oCityInfos.getTimeSpent(q)),I=s_oCityInfos.getRewardTaken(q),z=s_oCityInfos.getMedal(q),new CTLText(s_oStage,U,T,30,20,20,"center","#fff",FONT,1,0,0,I+TEXT_CURRENCY,!0,!0,!1,!1),z&&(z=createBitmap(s_oSpriteLibrary.getSprite(z+"_medal")),
z.x=G,z.y=P,z.scaleX=.6,z.scaleY=.6,s_oStage.addChild(z)),new CTLText(s_oStage,Q,N,250,18,18,"left","#fff",FONT,1,0,0,E,!0,!0,!1,!1),new CTLText(s_oStage,V,S,100,16,16,"right","#fff",FONT,1,0,0,F,!0,!0,!1,!1),N+=37,P+=37,T+=37,S+=37;z=s_oSpriteLibrary.getSprite("but_continue_small");b=CANVAS_WIDTH/2+340;a=CANVAS_HEIGHT-91;J=new CGfxButton(b,a,z,s_oStage);J.addEventListener(ON_MOUSE_UP,this._onButNextRelease,this);z=s_oSpriteLibrary.getSprite("but_exit");g=CANVAS_WIDTH-z.height/2-10;l=z.height/2+10;
R=new CGfxButton(g,l,z,s_oStage);R.addEventListener(ON_MOUSE_UP,this._onExit,this);if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)f=CANVAS_WIDTH-z.width/2-90,n=z.height/2+10,z=s_oSpriteLibrary.getSprite("audio_icon"),m=new CToggle(f,n,z,s_bAudioActive,s_oStage),m.addEventListener(ON_MOUSE_UP,this._onAudioToggle,this);z=window.document;q=z.documentElement;K=q.requestFullscreen||q.mozRequestFullScreen||q.webkitRequestFullScreen||q.msRequestFullscreen;L=z.exitFullscreen||z.mozCancelFullScreen||z.webkitExitFullscreen||
z.msExitFullscreen;!1===ENABLE_FULLSCREEN&&(K=!1);K&&screenfull.enabled&&(z=s_oSpriteLibrary.getSprite("but_fullscreen"),c=z.width/4+10,d=z.height/2+10,M=new CToggle(c,d,z,s_bFullscreen,s_oStage),M.addEventListener(ON_MOUSE_UP,this._onFullscreen,this));this.refreshButtonPos(s_iOffsetX,s_iOffsetY)};this.refreshButtonPos=function(a,b){R.setPosition(g-a,b+l);!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||m.setPosition(f-a,b+n);K&&screenfull.enabled&&M.setPosition(c+a,d+b)};this.makeVisibleSpeedBought=function(a){k[a].visible=
!1;w[a].visible=!0};this.makeVisibleEnergyBought=function(a){u[a].visible=!1;x[a].visible=!0};this.tryingToBuySpeed=function(){s_iSpeedBought<NUM_POWER_UP_AVAILABLE&&s_iPlayerMoney>=p[s_iSpeedBought]&&(s_oPlayerProgress.makeVisibleSpeedBought(s_iSpeedBought),s_iSpeedAdder+=PLAYER_MAX_SPEED_ADDER,s_iPlayerMoney-=p[s_iSpeedBought],s_oPlayerProgress.refreshMoneyCurrency(),s_iSpeedBought++,saveItem("100metres_Money",s_iPlayerMoney),saveItem("100metres_SpeedBought",s_iSpeedBought),saveItem("100metres_SpeedAdder",
s_iSpeedAdder),s_iSpeedBought<NUM_POWER_UP_AVAILABLE&&playSound("click",.5,!1))};this.tryingToBuyEnergy=function(){s_iEnergyBought<NUM_POWER_UP_AVAILABLE&&s_iPlayerMoney>=h[s_iEnergyBought]&&(s_oPlayerProgress.makeVisibleEnergyBought(s_iEnergyBought),s_iEnergyAdder+=PLAYER_ENERGY_ADDER,s_iPlayerMoney-=h[s_iEnergyBought],s_oPlayerProgress.refreshMoneyCurrency(),s_iEnergyBought++,saveItem("100metres_Money",s_iPlayerMoney),saveItem("100metres_EnergyBought",s_iEnergyBought),saveItem("100metres_EnergyAdder",
s_iEnergyAdder),s_iEnergyBought<NUM_POWER_UP_AVAILABLE&&playSound("upgrade",1,!1))};this.refreshMoneyCurrency=function(){O.refreshText("Money: "+s_iPlayerMoney+TEXT_CURRENCY)};this._onButNextRelease=function(){this.unload();s_oMain.gotoSelectLevel(D)};this._onExit=function(){s_oMain.gotoMenu();$(s_oMain).trigger("end_session")};this._onAudioToggle=function(){Howler.mute(s_bAudioActive);s_bAudioActive=!s_bAudioActive};this.unload=function(){K&&screenfull.enabled&&M.unload();if(!1===DISABLE_SOUND_MOBILE||
!1===s_bMobile)m.unload(),m=null;s_oStage.removeAllChildren();J.unload();s_oPlayerProgress=null};this.resetFullscreenBut=function(){K&&screenfull.enabled&&M.setActive(s_bFullscreen)};this._onFullscreen=function(){s_bFullscreen?L.call(window.document):K.call(window.document.documentElement);sizeHandler()};s_oPlayerProgress=this;this._init()}var s_oPlayerProgress=null;
function CVariousHelp(b,a){var c,d,f=CANVAS_WIDTH/2,n=CANVAS_HEIGHT/2,g,l,p,h;this._init=function(){d=new createjs.Container;d.x=f;d.y=n;d.alpha=0;l=new createjs.Shape;l.graphics.beginFill("#000000").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);l.alpha=.7;l.on("mousedown",this._onClick);s_oStage.addChild(l);if(a===WAIT_FOR_GAME_START){var e=s_oSpriteLibrary.getSprite("help_panel");c=createBitmap(e);c.regX=e.width/2;c.regY=e.height/2;d.addChild(c);new CTLText(d,-190,-210,400,24,24,"left","#fff",FONT,1,
0,0,TEXT_HELP,!0,!0,!1,!1);g=new CTLText(d,-140,-100,280,80,24,"center","#fff",FONT,1,0,0,b,!0,!0,!0,!1);s_bMobile?(g.refreshText(TEXT_START_MOVEMENT_MOBILE),e=createBitmap(s_oSpriteLibrary.getSprite("left_button")),e.x=-267,e.y=-121,d.addChild(e),e=createBitmap(s_oSpriteLibrary.getSprite("right_button")),e.x=143,e.y=-121,d.addChild(e)):(e=createBitmap(s_oSpriteLibrary.getSprite("left_directional_arrows")),e.x=-267,e.y=-121,d.addChild(e),e=createBitmap(s_oSpriteLibrary.getSprite("right_directional_arrows")),
e.x=143,e.y=-121,d.addChild(e));e=createBitmap(s_oSpriteLibrary.getSprite("horizontal_bar"));e.x=-140;e.y=20;e.scaleX=.5;e.scaleY=.5;d.addChild(e);new CTLText(d,-125,125,250,54,18,"center","#fff",FONT,1,0,0,HELP_ENERGY,!0,!1,!0,!1);e=s_oSpriteLibrary.getSprite("health");var k=createBitmap(e);k.x=96;k.y=84;k.regX=e.width;k.scaleX=.59;k.scaleY=.5;k.alpha=.9;d.addChild(k);e=s_oSpriteLibrary.getSprite("energy_bar");k=createBitmap(e);k.x=100;k.y=65;k.scaleX=.6;k.scaleY=.6;k.regX=e.width;d.addChild(k)}else a===
CONFIRMATION_ON_EXIT?(e=s_oSpriteLibrary.getSprite("are_you_sure_panel"),c=createBitmap(e),c.regX=e.width/2,c.regY=e.height/2,d.addChild(c),g=new CTLText(d,-180,-100,360,100,26,"center","#fff",FONT,1,0,0,b,!0,!0,!0,!1),p=new CGfxButton(-160,80,s_oSpriteLibrary.getSprite("but_exit"),d),p.addEventListener(ON_MOUSE_UP,this._onNo,this),h=new CGfxButton(160,80,s_oSpriteLibrary.getSprite("but_yes"),d),h.addEventListener(ON_MOUSE_UP,this._onYes,this)):a===CONFIRMATION_ON_CAREER_RESET&&(e=s_oSpriteLibrary.getSprite("are_you_sure_panel"),
c=createBitmap(e),c.regX=e.width/2,c.regY=e.height/2,d.addChild(c),g=new CTLText(d,-180,-100,360,100,26,"center","#fff",FONT,1,0,0,b,!0,!0,!0,!1),p=new CGfxButton(-160,80,s_oSpriteLibrary.getSprite("but_exit"),d),p.addEventListener(ON_MOUSE_UP,this._onNoCareerReset,this),h=new CGfxButton(160,80,s_oSpriteLibrary.getSprite("but_yes"),d),h.addEventListener(ON_MOUSE_UP,this._onYesCareerReset,this));s_oStage.addChild(d);this.show()};this.show=function(){createjs.Tween.get(d).to({alpha:1},500)};this._onNo=
function(){s_oGame.unloadVariousHelp(a)};this._onYes=function(){s_oGame.onExit()};this._onNoCareerReset=function(){s_oMenu.unloadVariousHelp()};this._onYesCareerReset=function(){s_oMenu.onContinue()};this._onClick=function(){a===WAIT_FOR_GAME_START&&(s_oGame.unloadVariousHelp(a),s_oGame.startGame())};this.unload=function(){createjs.Tween.get(d).to({alpha:0},500).call(function(){s_oStage.removeChild(d)});if(a===CONFIRMATION_ON_EXIT||a===CONFIRMATION_ON_CAREER_RESET)p.unload(),h.unload();l.off("mousedown",
this._onClick);s_oStage.removeChild(l)};this._init();s_oVariousHelp=this;return this}var s_oVariousHelp=null;
function CPodiumScreen(b){var a,c,d=0,f,n,g,l,p=[],h=s_oCityInfos.getPlayersArrivals(),e=[100,50,25,10,9,8,7,6],k=[0,1,2,3,4,5,6,7],w=[{x:CANVAS_WIDTH/2-215,y:CANVAS_HEIGHT/2-80},{x:CANVAS_WIDTH/2-322,y:CANVAS_HEIGHT/2-56},{x:CANVAS_WIDTH/2-108,y:CANVAS_HEIGHT/2-30}];this._init=function(){this.getRunnerInLane();this.addScoreToPlayers();this.findBestRunners();g=new createjs.Container;g.alpha=0;g.visible=!1;n=createBitmap(s_oSpriteLibrary.getSprite("bg_podium"));g.addChild(n);var b=new createjs.Shape;
b.graphics.beginFill("rgba(0,0,0,0.6)").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);g.addChild(b);b=createBitmap(s_oSpriteLibrary.getSprite("podium"));b.x=298;b.y=348;g.addChild(b);b=createBitmap(s_oSpriteLibrary.getSprite("final_score"));b.x=CANVAS_WIDTH/2;b.y=CANVAS_HEIGHT/2-150;g.addChild(b);s_oStage.addChild(g);var e=s_oSpriteLibrary.getSprite("but_restart");a=CANVAS_WIDTH/2+150;c=CANVAS_HEIGHT-160;l=new CGfxButton(a,c,e,g);l.addEventListener(ON_MOUSE_UP,this._onContinue,this);for(var f=0;3>f;f++)e=
s_oSpriteLibrary.getSprite("runner_"+k[f]+"_pose"),b=createBitmap(e),b.x=w[f].x,b.y=w[f].y,b.regX=e.width/2,b.regY=e.height/2,b.scaleX=b.scaleY=.85,s_oStage.addChild(b);for(f=0;f<k.length;f++)k[f]===s_iTeamSelected&&(new CTLText(s_oStage,CANVAS_WIDTH/2+100,CANVAS_HEIGHT/2-110,180,30,30,"center","#fff",FONT,1,0,0,f+1+TEXT_POSITION,!0,!0,!1,!1),new CTLText(s_oStage,CANVAS_WIDTH/2+15,CANVAS_HEIGHT/2-50,220,32,32,"left","#fff",FONT,1,0,0,TEXT_SCORE+d,!0,!0,!1,!1));this.refreshButtonPos(s_iOffsetX,s_iOffsetY)};
this.show=function(){g.visible=!0;createjs.Tween.get(g).to({alpha:1},500).call(function(){});$(s_oMain).trigger("share_event",d);$(s_oMain).trigger("save_score",[d])};this.getRunnerInLane=function(){for(var a=0;a<h[0].length;a++)p.push(PLAYER_NAME_AND_SPRITE[h[b][a].player].sprite),p[a]===s_iTeamSelected&&(f=a)};this.addScoreToPlayers=function(){for(var a=0;a<h[b].length;a++)s_aRunnersScore[h[b][a].player]+=e[h[b][a].position];d=s_aRunnersScore[h[b][f].player]};this.findBestRunners=function(){for(var a=
[],b=0;b<s_aRunnersScore.length;b++)a[b]=s_aRunnersScore[b];do{var c=!1;for(b=0;b<a.length;b++)a[b]<a[b+1]&&(c=a[b],a[b]=a[b+1],a[b+1]=c,c=k[b],k[b]=k[b+1],k[b+1]=c,c=!0)}while(c)};this._onContinue=function(){s_oStage.removeChild(g);l.unload();s_oGame.onExit()};this.refreshButtonPos=function(b,d){l.setPosition(a,c-d)};this._init();return this}
function CCreditsPanel(){var b,a,c,d,f,n,g,l;this._init=function(){l=new createjs.Container;s_oStage.addChild(l);var p=createBitmap(s_oSpriteLibrary.getSprite("bg_menu"));l.addChild(p);f=new createjs.Shape;f.graphics.beginFill("rgba(0,0,0,0.7)").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);l.addChild(f);p=s_oSpriteLibrary.getSprite("bg_credits");a=createBitmap(p);a.x=CANVAS_WIDTH/2;a.y=CANVAS_HEIGHT/2;a.regX=p.width/2;a.regY=p.height/2;l.addChild(a);n=new createjs.Shape;n.graphics.beginFill("#0f0f0f").drawRect(0,
0,CANVAS_WIDTH,CANVAS_HEIGHT);n.alpha=.01;n.on("click",this._onLogoButRelease);l.addChild(n);p=s_oSpriteLibrary.getSprite("but_exit");b=CANVAS_WIDTH/2+100;c=new CGfxButton(b,124,p,l);c.addEventListener(ON_MOUSE_UP,this.unload,this);d=new CFormatText(CANVAS_WIDTH/2,350,TEXT_CREDITS_DEVELOPED,"#ffffff",l,"#410701",20);p=s_oSpriteLibrary.getSprite("logo_credits");var h=createBitmap(p);h.regX=p.width/2;h.regY=p.height/2;h.x=CANVAS_WIDTH/2;h.y=400;l.addChild(h);g=new CFormatText(CANVAS_WIDTH/2,450,TEXT_LINK1,
"#ffffff",l,"#410701",16)};this.unload=function(){n.off("click",this._onLogoButRelease);c.unload();c=null;d.unload();g.unload();s_oStage.removeChild(l)};this._onLogoButRelease=function(){window.open("http://watchdocumentaries.com/games/")};this._init()}
function CFormatText(b,a,c,d,f,n,g){var l,p,h,e,k;this._init=function(a,b,c,d,f,g,k){l=c;e=new createjs.Container;e.x=a;e.y=b;f.addChild(e);a=k+"px";p=new createjs.Text;p.text=l;p.font=a+" "+FONT;p.color=g;p.textAlign="center";p.textBaseline="middle";p.lineWidth=600;p.outline=4;h=new createjs.Text;h.text=l;h.font=a+" "+FONT;h.color=d;h.textAlign="center";h.textBaseline="middle";h.lineWidth=600;e.addChild(h)};this.unload=function(){f.removeChild(e)};this.disableOutline=function(){e.removeChild(p)};
this.setVisible=function(a){e.visible=a};this.isVisible=function(){return e.visible};this.setOutline=function(a){p.outline=a};this.setShadow=function(a){p.shadow=a?new createjs.Shadow("#333333",2,2,6):null};this.setAlign=function(a){p.textAlign=a;h.textAlign=a};this.setWidth=function(a){p.lineWidth=a;h.lineWidth=a};this.setText=function(a){h.text=a;p.text=a};this.setColor=function(a,b){h.color=a;p.color=b};this.setFont=function(a){var b=g+"px";h.font=b+" "+a;p.font=b+" "+a};this.getText=function(){return e};
this.setPos=function(a){e.y=a};this.getPos=function(){return{x:e.x,y:e.y}};this.playText=function(){k="";this.setText("");this._slideText(0)};this._slideText=function(a){k+=c[a];this.setText(k);a<c.length-1&&setTimeout(function(){w._slideText(a+1)},40)};this.setPosition=function(a,b){e.x=a;e.y=b};var w=this;this._init(b,a,c,d,f,n,g)}
function CArrivalPanel(b,a,c){var d,f,n,g,l,p,h;this._init=function(){d=b;f=a;h=new createjs.Container;h.x=d;h.y=f;h.visible=!1;e.addChild(h);var c=createBitmap(s_oSpriteLibrary.getSprite("arrival_panel"));h.addChild(c);n=new CTLText(h,10,6,50,15,15,"left","#fff",FONT,1,0,0," ",!0,!0,!1,!1);g=new CTLText(h,10,24,120,12,12,"left","#fff",FONT,1,0,0," ",!0,!0,!1,!1);l=new CTLText(h,150,6,80,15,15,"right","#fff",FONT,1,0,0,TEXT_LANE+": ",!0,!0,!1,!1);p=new CTLText(h,150,24,80,15,15,"right","#fff",FONT,
1,0,0," ",!0,!0,!1,!1)};this.refreshButtonPos=function(a,b){h.visible&&(h.x=d-a,h.y=f+b)};this.show=function(a,b,c){var e="";switch(c){case 1:e=c+"st";break;case 2:e=c+"nd";break;case 3:e=c+"rd";break;case 4:case 5:case 6:case 7:case 8:e=c+"th"}c=b.lane+1;var k=b.name;b=b.time;n.refreshText(e);l.refreshText(TEXT_LANE+": "+c);g.refreshText(k);p.refreshText(b);h.visible=!0;createjs.Tween.get(h).to({x:a},100,createjs.Ease.quadInOut).call(function(){d=h.x;f=h.y})};this.hide=function(a){createjs.Tween.get(h).to({x:a},
300,createjs.Ease.quadInOut).call(function(){h.visible=!1})};this.getX=function(){return h.x};this.getY=function(){return h.y};var e=c;this._init()}
function CMsgBox(b,a){var c,d;this._init=function(a){d=new createjs.Container;n.addChild(d);a=new createjs.Shape;a.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);a.alpha=.5;a.on("click",function(){});d.addChild(a);a=s_oSpriteLibrary.getSprite("help_panel");var b=createBitmap(a);b.x=.5*CANVAS_WIDTH;b.y=.5*CANVAS_HEIGHT;b.regX=.5*a.width;b.regY=.5*a.height;d.addChild(b);new CTLText(d,CANVAS_WIDTH/2-275,180,550,240,30,"center","#fff",FONT,1,0,0,TEXT_ERR_LS,!0,!0,!0,!1);c=new CGfxButton(CANVAS_WIDTH/
2,470,s_oSpriteLibrary.getSprite("but_yes"),d);c.addEventListener(ON_MOUSE_UP,this._onButOk,this)};this._onButOk=function(){f.unload()};this.unload=function(){c.unload();n.removeChild(d)};var f=this;var n=a;this._init(b)}
CTLText.prototype={constructor:CTLText,__autofit:function(){if(this._bFitText){for(var b=this._iFontSize;(this._oText.getBounds().height>this._iHeight-2*this._iPaddingV||this._oText.getBounds().width>this._iWidth-2*this._iPaddingH)&&!(b--,this._oText.font=b+"px "+this._szFont,this._oText.lineHeight=Math.round(b*this._fLineHeightFactor),this.__updateY(),this.__verticalAlign(),8>b););this._iFontSize=b}},__verticalAlign:function(){if(this._bVerticalAlign){var b=this._oText.getBounds().height;this._oText.y-=
(b-this._iHeight)/2+this._iPaddingV}},__updateY:function(){this._oText.y=this._y+this._iPaddingV;switch(this._oText.textBaseline){case "middle":this._oText.y+=this._oText.lineHeight/2+(this._iFontSize*this._fLineHeightFactor-this._iFontSize)}},__createText:function(b){this._bDebug&&(this._oDebugShape=new createjs.Shape,this._oDebugShape.graphics.beginFill("rgba(255,0,0,0.5)").drawRect(this._x,this._y,this._iWidth,this._iHeight),this._oContainer.addChild(this._oDebugShape));this._oText=new createjs.Text(b,
this._iFontSize+"px "+this._szFont,this._szColor);this._oText.textBaseline="middle";this._oText.lineHeight=Math.round(this._iFontSize*this._fLineHeightFactor);this._oText.textAlign=this._szAlign;this._oText.lineWidth=this._bMultiline?this._iWidth-2*this._iPaddingH:null;switch(this._szAlign){case "center":this._oText.x=this._x+this._iWidth/2;break;case "left":this._oText.x=this._x+this._iPaddingH;break;case "right":this._oText.x=this._x+this._iWidth-this._iPaddingH}this._oContainer.addChild(this._oText);
this.refreshText(b)},setVerticalAlign:function(b){this._bVerticalAlign=b},setOutline:function(b){null!==this._oText&&(this._oText.outline=b)},setShadow:function(b,a,c,d){null!==this._oText&&(this._oText.shadow=new createjs.Shadow(b,a,c,d))},setColor:function(b){this._oText.color=b},setAlpha:function(b){this._oText.alpha=b},removeTweens:function(){createjs.Tween.removeTweens(this._oText)},getText:function(){return this._oText},getY:function(){return this._y},getFontSize:function(){return this._iFontSize},
refreshText:function(b){""===b&&(b=" ");null===this._oText&&this.__createText(b);this._oText.text=b;this._oText.font=this._iFontSize+"px "+this._szFont;this._oText.lineHeight=Math.round(this._iFontSize*this._fLineHeightFactor);this.__autofit();this.__updateY();this.__verticalAlign()}};
function CTLText(b,a,c,d,f,n,g,l,p,h,e,k,w,v,t,r,u){this._oContainer=b;this._x=a;this._y=c;this._iWidth=d;this._iHeight=f;this._bMultiline=r;this._iFontSize=n;this._szAlign=g;this._szColor=l;this._szFont=p;this._iPaddingH=e;this._iPaddingV=k;this._bVerticalAlign=t;this._bFitText=v;this._bDebug=u;this._oDebugShape=null;this._fLineHeightFactor=h;this._oText=null;w&&this.__createText(w)};